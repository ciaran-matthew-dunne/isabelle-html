<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Connection_locale</title>
</head>


<body>
<div class="head">
<h1>Theory Connection_locale</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Connection_locale
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Model_locale.html">Model_locale</a>
  <span class="keyword2"><span class="keyword">keywords</span></span> <span class="quoted">"lift_model_defs"</span> <span class="main">::</span> thy_goal 
<span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1"><span class="command">ML_file</span></span> <span class="quoted">‹transfer_all_method.ML›</span>

<span class="keyword1"><span class="command">locale</span></span> Connection <span class="main">=</span> Model <span class="quoted"><span class="free">Ord</span></span> <span class="quoted"><span class="free">lt</span></span> <span class="quoted"><span class="free">zero</span></span> <span class="quoted"><span class="free">succ</span></span> <span class="quoted"><span class="free">Limit</span></span> <span class="quoted"><span class="free">predSet</span></span> <span class="quoted"><span class="free">OrdRec</span></span> <span class="quoted"><span class="free">omega</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> 
    <span class="free">Ord</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">lt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‹<span class="keyword1">&lt;</span>›</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">zero</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">0</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">succ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">Limit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">predSet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">OrdRec</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">omega</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">ω</span>›</span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> 
    <span class="free">Abs</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">Rep</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'j</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 
    td <span class="main">:</span> <span class="quoted"><span class="quoted">"type_definition <span class="free">Rep</span> <span class="free">Abs</span> <span class="main">(</span>Set.Collect <span class="keyword1">M</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">context</span></span> Connection <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">context</span></span> <span class="keyword2"><span class="keyword">includes</span></span> lifting_syntax <span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">thm</span></span> Connection_axioms
<span class="keyword1"><span class="command">find_theorems</span></span> <span class="quoted">Connection</span>

<span class="keyword1"><span class="command">find_theorems</span></span> <span class="quoted"><span class="quoted">"GZF_locale.GZF"</span></span>
<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹<span class="entity">Locale.get_intros</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">context</span><span class="antiquote">}</span></span></span>›</span>
<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span>SOME <span class="entity">intros</span><span class="main">)</span> <span class="main">=</span> fst <span class="main">(</span><span class="entity">Locale.intros_of</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">theory</span><span class="antiquote">}</span></span></span> <span class="inner_quoted">"GZF_locale.GZF"</span><span class="main">)</span>›</span> 
<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">assms</span> <span class="main">=</span> Thm.prems_of <span class="entity">intros</span>›</span>
<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword">val</span></span> <span class="main">[</span><span class="entity">Element.Assumes</span> <span class="entity">it</span><span class="main">]</span> <span class="main">=</span> <span class="entity">Locale.hyp_spec_of</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">theory</span><span class="antiquote">}</span></span></span> <span class="inner_quoted">"GZF_locale.GZF"</span>›</span>

<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹
  <span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_locale_assms</span> <span class="entity">thy</span> <span class="entity">str</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
      <span class="keyword1"><span class="keyword">val</span></span> <span class="main">[</span><span class="entity">Element.Assumes</span> <span class="entity">assms</span><span class="main">]</span> <span class="main">=</span> <span class="entity">Locale.hyp_spec_of</span> <span class="entity">thy</span> <span class="entity">str</span>
  <span class="keyword2"><span class="keyword">in</span></span> map <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">bind</span> <span class="main">=&gt;</span> <span class="entity">str</span> ^ <span class="inner_quoted">"."</span> ^ <span class="main">(</span>Binding.name_of <span class="entity">bind</span><span class="main">)</span><span class="main">)</span> o fst o fst<span class="main">)</span> <span class="entity">assms</span> <span class="keyword2"><span class="keyword">end</span></span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">it</span> <span class="main">=</span> map <span class="main">(</span><span class="entity">get_locale_assms</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">theory</span><span class="antiquote">}</span></span></span><span class="main">)</span> 
          <span class="main">[</span><span class="inner_quoted">"GZF_locale.GZF"</span><span class="main">,</span> <span class="inner_quoted">"Ord_locale.Ord"</span><span class="main">,</span> <span class="inner_quoted">"Model_locale.Model"</span><span class="main">,</span> <span class="inner_quoted">"Connection_locale.Connection"</span><span class="main">]</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">it2</span> <span class="main">=</span> List.concat <span class="entity">it</span> 
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">it3</span> <span class="main">=</span> Pretty.big_list <span class="inner_quoted">""</span> <span class="main">(</span>map <span class="main">(</span>Pretty.str<span class="main">)</span> <span class="entity">it2</span><span class="main">)</span>  ›</span>



<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‹<span class="entity">Locale.pretty_locale</span> <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">theory</span><span class="antiquote">}</span></span></span> true <span class="inner_quoted">"GZF_locale.GZF"</span>›</span>
<span class="keyword1"><span class="command">interpretation</span></span> connect<span class="main">:</span> type_definition <span class="quoted"><span class="quoted">"<span class="free">Rep</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Abs</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Set.Collect <span class="keyword1">M</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> td<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">md</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'j</span> <span class="main">⇒</span> bool"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">md</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free">Rep</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">ML_file</span></span> <span class="quoted">‹swap_transfer.ML›</span>

<span class="keyword1"><span class="command">lemma</span></span> M_abs_inverse <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> connect.Abs_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">lemma</span></span> M_rep <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="main">(</span><span class="free">Rep</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> connect.Rep <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">declare</span></span> M_abs_inverse connect.Rep_inverse <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemmas</span></span> forceM_inverse <span class="main">=</span> M_abs_inverse<span class="main">[</span><span class="operator">OF</span> forceM_elim<span class="main">]</span> 

<span class="keyword1"><span class="command">lemma</span></span> binpred_transfer <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="free">P</span> <span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="bound">a</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="bound">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free">P</span> <span class="main">(</span>forceM <span class="bound">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="bound">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span> 
  <span class="keyword1"><span class="command">have</span></span> ab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">a</span> <span class="main">∧</span> <span class="keyword1">M</span> <span class="bound">b</span> <span class="main">⟶</span> <span class="main">(</span><span class="free">P</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">⟷</span> <span class="free">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">a</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> pq <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a'</span> <span class="bound">b'</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="skolem">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">b'</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">P</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">⟷</span> <span class="free">Q</span> <span class="bound">a'</span> <span class="bound">b'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="skolem">a</span> <span class="main">∧</span> <span class="keyword1">M</span> <span class="skolem">b</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">P</span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">⟷</span> <span class="free">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">b</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">" <span class="free">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">(</span>forceM <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="skolem">b</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> forceM_elim ab<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹forceM <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹forceM <span class="skolem">b</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unfun_transfer <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="free">F</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Rep</span> <span class="main">(</span><span class="free">G</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span> <span class="bound">a'</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="free">F</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">G</span> <span class="bound">a'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> forceM_inverse <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹forceM <span class="free">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> binfun_transfer <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="free">F</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Rep</span> <span class="main">(</span><span class="free">G</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">F</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> ab<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span> <span class="bound">a'</span> <span class="bound">b</span> <span class="bound">b'</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="bound">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">b'</span> <span class="main">⟹</span> <span class="free">F</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">G</span> <span class="bound">a'</span> <span class="bound">b'</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> forceM_inverse <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>forceM <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">b</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ab<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹forceM <span class="free">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">a</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹forceM <span class="free">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="main">(</span>forceM <span class="free">b</span><span class="main">)</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lift_model_defs</span></span> lift_base<span class="main">:</span> mOrd 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mMem <span class="free">cMem</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cMem_def md_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md mEmp <span class="free">cEmp</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cEmp_def md_def <span class="keyword1"><span class="command">using</span></span> closed_gzf<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mSet <span class="free">cSet</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cSet_def md_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> mUnion <span class="free">cUnion</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cUnion_def md_def <span class="keyword1"><span class="command">using</span></span> closed_gzf<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mSubset <span class="free">cSubset</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cSubset_def md_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> mPow <span class="free">cPow</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cPow_def md_def <span class="keyword1"><span class="command">using</span></span> closed_gzf<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> mSucc <span class="free">cSucc</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cSucc_def md_def <span class="keyword1"><span class="command">using</span></span> closed_gzf<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md mInf <span class="free">cInf</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cInf_def md_def <span class="keyword1"><span class="command">using</span></span> closed_gzf<span class="main">(</span>5<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> mRepl <span class="free">cRepl</span>"</span></span>   
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> md <span class="main">(</span>mRepl <span class="skolem">P</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">(</span><span class="free">cRepl</span> <span class="skolem">Q</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> md_def mRepl_def cRepl_def<span class="main"><span class="keyword3">,</span></span> 
           <span class="operator">subst</span> binpred_transfer<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pq<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">fold</span> mRepl_def<span class="main"><span class="keyword3">,</span></span> 
           <span class="operator">use</span> closed_gzf<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mOrd <span class="free">cOrd</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def cOrd_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mlt <span class="free">clt</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def clt_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md mzero <span class="free">czero</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def czero_def <span class="keyword1"><span class="command">using</span></span> closed_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> msucc <span class="free">csucc</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def csucc_def <span class="keyword1"><span class="command">using</span></span> closed_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> mLimit <span class="free">cLimit</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cLimit_def md_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> mpredSet <span class="free">cpredSet</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cpredSet_def md_def <span class="keyword1"><span class="command">using</span></span> closed_ord<span class="main">(</span>9<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> <span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> 
          md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> mOrdRec <span class="free">cOrdRec</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">L</span> <span class="skolem">L'</span> <span class="skolem">F</span> <span class="skolem">F'</span> <span class="skolem">A</span> <span class="skolem">A'</span> <span class="skolem">β</span> <span class="skolem">β'</span>
    <span class="keyword3"><span class="command">assume</span></span> L<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="skolem">L</span> <span class="skolem">L'</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> F<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="skolem">F</span> <span class="skolem">F'</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"md <span class="skolem">A</span> <span class="skolem">A'</span>"</span></span>
       <span class="keyword2"><span class="keyword">and</span></span> β<span class="main">:</span> <span class="quoted"><span class="quoted">"md <span class="skolem">β</span> <span class="skolem">β'</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md <span class="main">(</span>mOrdRec <span class="skolem">L</span> <span class="skolem">F</span> <span class="skolem">A</span> <span class="skolem">β</span><span class="main">)</span> <span class="main">(</span><span class="free">cOrdRec</span> <span class="skolem">L'</span> <span class="skolem">F'</span> <span class="skolem">A'</span> <span class="skolem">β'</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> md_def cOrdRec_def mOrdRec_def<span class="main"><span class="keyword3">,</span></span>
            <span class="operator">subst</span> binfun_transfer<span class="main"><span class="main">[</span></span><span class="operator">OF</span> L<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
            <span class="operator">subst</span> binfun_transfer<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span>
            <span class="operator">insert</span> A β<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> md_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">fold</span> mOrdRec_def<span class="main"><span class="keyword3">,</span></span>
            <span class="operator">use</span> closed_ord<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"md momega <span class="free">comega</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> comega_def md_def <span class="keyword1"><span class="command">using</span></span> closed_ord<span class="main">(</span>11<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">declare</span></span> lift_base <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span>


<span class="comment1">(*WARNING: BOILERPLATE
  Ciaran: Please figure out how to just generate these theorems for free.*)</span>
<span class="keyword1"><span class="command">lemma</span></span> all_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span> <span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">(</span>mall<span class="main">)</span> <span class="main">(</span>All<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">x</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"mall <span class="skolem">P</span> <span class="main">⟷</span> All <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> mall_def rall_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x'</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">(</span><span class="free">Rep</span> <span class="skolem">x'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span> <span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Q <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">`<span class="keyword1">M</span> <span class="skolem">x</span>`</span></span> x<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">x</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
    

<span class="keyword1"><span class="command">lemma</span></span> ex_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span> <span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">(</span>mex<span class="main">)</span> <span class="main">(</span>Ex<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">x</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"mex <span class="skolem">P</span> <span class="main">⟷</span> Ex <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> mex_def rex_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> P<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="bound">x</span>"</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Ex <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Ex <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span> <span class="quoted"><span class="quoted">"Ex <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">x'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Q <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="main">(</span><span class="free">Rep</span> <span class="skolem">x'</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="main">(</span><span class="free">Rep</span> <span class="skolem">x'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="bound">x</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> uniq_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span> <span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">(</span>muniq<span class="main">)</span> <span class="main">(</span>Uniq<span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">x</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">x'</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> rel_funD<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"muniq <span class="skolem">P</span> <span class="main">⟷</span> Uniq <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> muniq_def mall_def rall_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> P <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Uniq <span class="skolem">Q</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x'</span> <span class="skolem">y'</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">x'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">y'</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">Rep</span> <span class="skolem">x'</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">Rep</span> <span class="skolem">y'</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> P <span class="keyword1"><span class="command">have</span></span> xy<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="var">?x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="var">?y</span> <span class="main">⟶</span> <span class="var">?x</span> <span class="main">=</span> <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">=</span> <span class="skolem">y'</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="var">?x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="var">?y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="skolem">x'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="skolem">y'</span>›</span></span> x <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x'</span> <span class="main">=</span> <span class="skolem">y'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xy connect.Rep_inject <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span> <span class="quoted"><span class="quoted">"Uniq <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">x</span> <span class="main">∧</span> <span class="skolem">P</span> <span class="skolem">y</span>"</span></span> 
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">x</span>›</span></span><span class="main">]</span> x<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Abs</span> <span class="skolem">y</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">Abs</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">Abs</span> <span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Q <span class="keyword1"><span class="command">unfolding</span></span> Uniq_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> connect.Abs_inject <span class="quoted"><span class="quoted">‹<span class="keyword1">M</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">M</span> <span class="skolem">y</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> eq_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">(=)</span> <span class="main">(=)</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> md_def rel_fun_def <span class="keyword1"><span class="command">using</span></span> connect.Rep_inject <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> binpred_all_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span> <span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> All All"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">V</span>  
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> <span class="main">===&gt;</span> <span class="main">(=)</span><span class="main">)</span> <span class="skolem">U</span> <span class="skolem">V</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> pq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">P</span> <span class="bound">Q</span><span class="main">.</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">a</span> <span class="bound">a'</span> <span class="bound">b</span> <span class="bound">b'</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="bound">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">b'</span> <span class="main">⟹</span> <span class="bound">P</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">⟷</span> <span class="bound">Q</span> <span class="bound">a'</span> <span class="bound">b'</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">U</span> <span class="bound">P</span> <span class="main">⟷</span> <span class="skolem">V</span> <span class="bound">Q</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> md_def rel_fun_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">U</span> <span class="main">=</span> All <span class="skolem">V</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">"All <span class="skolem">U</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">V</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Q</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'j</span> <span class="main">⇒</span> <span class="tfree">'j</span> <span class="main">⇒</span> bool"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="skolem">Q</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">a</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">b</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span> <span class="bound">a'</span> <span class="bound">b</span> <span class="bound">b'</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="bound">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">b'</span> <span class="main">⟹</span> <span class="var">?P</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">a'</span> <span class="bound">b'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="var">?P</span> <span class="main">⟷</span> <span class="skolem">V</span> <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pq<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="skolem">Q</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> U <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> V<span class="main">:</span> <span class="quoted"><span class="quoted">"All <span class="skolem">V</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">U</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> bool"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Q</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">a'</span> <span class="bound">b'</span><span class="main">.</span> <span class="skolem">P</span> <span class="main">(</span><span class="free">Rep</span> <span class="bound">a'</span><span class="main">)</span> <span class="main">(</span><span class="free">Rep</span> <span class="bound">b'</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span> <span class="bound">a'</span> <span class="bound">b</span> <span class="bound">b'</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">a'</span> <span class="main">⟹</span> <span class="bound">b</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">b'</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">⟷</span> <span class="var">?Q</span> <span class="bound">a'</span> <span class="bound">b'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="skolem">P</span> <span class="main">⟷</span> <span class="skolem">V</span> <span class="var">?Q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pq<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="skolem">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> V <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unfun_all_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> fun_mall All"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> FG<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="bound">F</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="bound">G</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> md_def rel_fun_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"fun_mall <span class="skolem">P</span> <span class="main">⟷</span> All <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">"fun_mall <span class="skolem">P</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">G</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'j</span> <span class="main">⇒</span> <span class="tfree">'j</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Rep</span> <span class="main">(</span><span class="skolem">G</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="var">?F</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="skolem">G</span> <span class="bound">x'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="var">?F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P <span class="keyword1"><span class="command">unfolding</span></span> fun_mall_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"fun_mall <span class="skolem">P</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> fun_mall_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> M<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="keyword1">M</span> <span class="main">(</span><span class="skolem">F</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Abs</span> <span class="main">(</span><span class="skolem">F</span> <span class="main">(</span><span class="free">Rep</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="skolem">F</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="var">?G</span> <span class="bound">x'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="var">?G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Q <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> binfun_all_transfer <span class="main">[</span><span class="operator">transfer_rule</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> binfun_mall All"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">Q</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>md <span class="main">===&gt;</span> md <span class="main">===&gt;</span> md<span class="main">)</span> <span class="main">===&gt;</span> iff<span class="main">)</span> <span class="skolem">P</span> <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> FG<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span> <span class="bound">y</span> <span class="bound">y'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">y'</span> <span class="main">⟹</span> <span class="bound">F</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="bound">G</span> <span class="bound">x'</span> <span class="bound">y'</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">P</span> <span class="bound">F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="bound">G</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> md_def rel_fun_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"binfun_mall <span class="skolem">P</span> <span class="main">⟷</span> All <span class="skolem">Q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">"binfun_mall <span class="skolem">P</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">G</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'j</span> <span class="main">⇒</span> <span class="tfree">'j</span> <span class="main">⇒</span> <span class="tfree">'j</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">Rep</span> <span class="main">(</span><span class="skolem">G</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">Abs</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span> <span class="bound">y</span> <span class="bound">y'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">y'</span> <span class="main">⟹</span> <span class="var">?F</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="skolem">G</span> <span class="bound">x'</span> <span class="bound">y'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="var">?F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="skolem">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P <span class="keyword1"><span class="command">unfolding</span></span> binfun_mall_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">"All <span class="skolem">Q</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"binfun_mall <span class="skolem">P</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> binfun_mall_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span> 
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">F</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span> <span class="main">⇒</span> <span class="tfree">'i</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> M<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">∧</span> <span class="keyword1">M</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="keyword1">M</span> <span class="main">(</span><span class="skolem">F</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">Abs</span> <span class="main">(</span><span class="skolem">F</span> <span class="main">(</span><span class="free">Rep</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">Rep</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">x'</span> <span class="bound">y</span> <span class="bound">y'</span><span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">x'</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="bound">y'</span> <span class="main">⟹</span> <span class="skolem">F</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">=</span> <span class="free">Rep</span> <span class="main">(</span><span class="var">?G</span> <span class="bound">x'</span> <span class="bound">y'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> M <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">F</span> <span class="main">⟷</span> <span class="skolem">Q</span> <span class="var">?G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Q <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="comment1">(*END BOILERPLATE*)</span>

<span class="comment1">(*From here we can interpret the Base locale, and get GZF/Ordinal definitions on 'j for free.
  If we then define an Ops operator, we can invoke the model locale.
  If we then give a type_definition on this model, we can invoke the Connection locale
  and repeat the process. *)</span>
<span class="keyword1"><span class="command">interpretation</span></span> interp <span class="main">:</span> Ord <span class="quoted">cMem</span> <span class="quoted">cEmp</span> <span class="quoted">cSet</span> <span class="quoted">cUnion</span> <span class="quoted">cSubset</span> <span class="quoted">cPow</span> <span class="quoted">cSucc</span> <span class="quoted">cInf</span> <span class="quoted">cRepl</span> 
                            <span class="quoted">cOrd</span> <span class="quoted">clt</span> <span class="quoted">czero</span> <span class="quoted">csucc</span> <span class="quoted">cLimit</span> <span class="quoted">cpredSet</span> <span class="quoted">cOrdRec</span> <span class="quoted">comega</span> 
  <span class="keyword1"><span class="command">sorry</span></span>
<span class="comment1">(* proof (unfold_locales, transfer_all,
      rule trans_gzf(1), rule trans_gzf(2), rule trans_gzf(3), 
      rule trans_gzf(4), rule trans_gzf(5), rule trans_gzf(6), 
      rule trans_gzf(7), rule trans_gzf(8), rule trans_gzf(9)) *)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>