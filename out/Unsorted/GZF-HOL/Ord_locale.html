<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Ord_locale</title>
</head>


<body>
<div class="head">
<h1>Theory Ord_locale</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Ord_locale
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="GZF_locale.html">GZF_locale</a> <a href="../../HOL/HOL/Orderings.html">HOL.Orderings</a> <span class="keyword2"><span class="keyword">begin</span></span>


<span class="comment1">(*It would be nice to use the ‹class.wellorder› locale, but unfortunately
  this assumes that the entire type is well-ordered by leq and lt, 
  but we just want this to be true for the ordinal portion.
  We could assume an 'Ordinal' subtype and assume an instantiation of the wellorder class on there, 
  then I imagine that the types-to-sets stuff could port all of the theorems we would import from type class
  to the portion of 'd such that Ord x holds.
  But this is too much work just to avoid assuming the axioms manually.  *)</span>


<span class="keyword1"><span class="command">locale</span></span> Ord <span class="main">=</span> GZF <span class="quoted"><span class="free">Mem</span></span> <span class="quoted"><span class="free">Emp</span></span> <span class="quoted"><span class="free">Set</span></span> <span class="quoted"><span class="free">Union</span></span> <span class="quoted"><span class="free">Subset</span></span> <span class="quoted"><span class="free">Pow</span></span> <span class="quoted"><span class="free">Succ</span></span> <span class="quoted"><span class="free">Inf</span></span> <span class="quoted"><span class="free">Repl</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="free">Mem</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‹<span class="keyword1">∈</span>›</span> 50<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Emp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">∅</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> bool"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">⋃</span>_›</span> <span class="main">[</span>90<span class="main">]</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Subset</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‹<span class="keyword1">⊆</span>›</span> 50<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pow</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">𝒫</span>›</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Succ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Inf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span>  <span class="comment1">― ‹witness of Infinity›</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Repl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">⇒</span> bool<span class="main">]</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span><span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">ℛ</span>›</span> 90<span class="main">)</span>  <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span>
    <span class="free">Ord</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">lt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‹<span class="keyword1">&lt;</span>›</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">zero</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">0</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">succ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">Limit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">predSet</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">OrdRec</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span><span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">omega</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">ω</span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 
    <span class="comment1">(*Axioms for the Ord predicate*)</span>
    zero_ord <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main"><span class="free">0</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ω_ord <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="keyword1"><span class="free">ω</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    lt_ord <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span> <span class="main">⟶</span> <span class="free">Ord</span> <span class="free">i</span> <span class="main">∧</span> <span class="free">Ord</span> <span class="free">j</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ord_succ_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">(</span><span class="free">succ</span> <span class="free">i</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Ord</span> <span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="comment1">(*Definition of 0, succ, leq and Limit*)</span>
    zero_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="main"><span class="free">0</span></span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    succ_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">β</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">β</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">α</span><span class="main">.</span> <span class="bound">α</span> <span class="main"><span class="free">&lt;</span></span> <span class="main">(</span><span class="free">succ</span> <span class="bound">β</span><span class="main">)</span> <span class="main">⟷</span> <span class="bound">α</span> <span class="main">=</span> <span class="bound">β</span> <span class="main">∨</span> <span class="bound">α</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">β</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    limit_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">μ</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">Ord</span> <span class="free">μ</span> <span class="main">∧</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">&lt;</span></span> <span class="free">μ</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">β</span><span class="main">.</span> <span class="bound">β</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">μ</span> <span class="main">⟶</span> <span class="free">succ</span> <span class="bound">β</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">μ</span><span class="main">)</span><span class="main">)</span> "</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="comment1">(*Characterisation of &lt; as a wellorder*)</span>
    lt_trans <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span> <span class="bound">j</span> <span class="bound">k</span><span class="main">.</span> <span class="bound">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">j</span> <span class="main">⟶</span> <span class="bound">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">k</span> <span class="main">⟶</span> <span class="bound">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    lt_notsym <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="bound">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">j</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="bound">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    lt_linear <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span> <span class="bound">j</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">i</span> <span class="main">∧</span> <span class="free">Ord</span> <span class="bound">j</span> <span class="main">⟶</span> <span class="bound">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">j</span> <span class="main">|</span> <span class="bound">i</span> <span class="main">=</span> <span class="bound">j</span> <span class="main">|</span> <span class="bound">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    lt_induct <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">a</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">x</span> <span class="main">⟶</span> <span class="free">P</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>

    predset_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">β</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">β</span> <span class="main">⟶</span> <span class="free">Set</span> <span class="main">(</span><span class="free">predSet</span> <span class="bound">β</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">α</span><span class="main">.</span> <span class="bound">α</span> <span class="main"><span class="free">∈</span></span> <span class="free">predSet</span> <span class="bound">β</span> <span class="main">⟷</span> <span class="bound">α</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">β</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ordrec_0 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span><span class="main">.</span> <span class="free">OrdRec</span> <span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="main"><span class="free">0</span></span> <span class="main">=</span> <span class="bound">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    ordrec_succ <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="bound">b</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">b</span> <span class="main">⟶</span> 
      <span class="free">OrdRec</span> <span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="main">(</span><span class="free">succ</span> <span class="bound">b</span><span class="main">)</span> <span class="main">=</span> <span class="bound">F</span> <span class="main">(</span><span class="free">succ</span> <span class="bound">b</span><span class="main">)</span> <span class="main">(</span><span class="free">OrdRec</span> <span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="bound">b</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ordrec_lim <span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="bound">z</span><span class="main">.</span> <span class="free">Limit</span> <span class="bound">z</span> <span class="main">⟶</span> 
      <span class="free">OrdRec</span> <span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="bound">z</span> <span class="main">=</span> <span class="bound">G</span> <span class="bound">z</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="bound">z</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">β</span><span class="main">.</span> <span class="free">OrdRec</span> <span class="bound">G</span> <span class="bound">F</span> <span class="bound">A</span> <span class="bound">β</span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="keyword1"><span class="command">context</span></span> Ord <span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1"><span class="command">lemma</span></span> lt_ord1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">==&gt;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lt_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_ord2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">==&gt;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lt_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> succ_ord <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">(</span><span class="free">succ</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> succ_ordD <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">(</span><span class="free">succ</span> <span class="free">i</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Ord</span> <span class="free">i</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> ord_succ_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> predset_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">β</span> <span class="main">⟹</span> <span class="free">Set</span> <span class="main">(</span><span class="free">predSet</span> <span class="free">β</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> predset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> predset_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">β</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">α</span> <span class="main"><span class="free">∈</span></span> <span class="free">predSet</span> <span class="free">β</span> <span class="main">⟷</span> <span class="free">α</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">β</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> predset_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> predset_mem_ord <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">β</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">α</span> <span class="main"><span class="free">∈</span></span> <span class="free">predSet</span> <span class="free">β</span> <span class="main">⟹</span> <span class="free">Ord</span> <span class="free">α</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> predset_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="free">Ord</span> <span class="free">β</span>›</span></span><span class="main">]</span> lt_ord1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> succ_lt <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">β</span> <span class="main">⟹</span> <span class="free">β</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">succ</span> <span class="free">β</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">one</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">1</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">1</span></span> <span class="main">≡</span> <span class="free">succ</span> <span class="main"><span class="free">0</span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">three</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">3</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">3</span></span> <span class="main">≡</span> <span class="free">succ</span> <span class="main">(</span><span class="free">succ</span> <span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> one_def <span class="keyword1"><span class="command">using</span></span> succ_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_3 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">3</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> three_def <span class="keyword1"><span class="command">using</span></span> succ_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> trans_induct <span class="main">[</span><span class="operator">consumes</span> 1<span class="main">,</span> <span class="operator">case_names</span> step<span class="main">]</span> <span class="main">:</span> 
 <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">i</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">x</span> <span class="main">⟹</span> <span class="free">P</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lt_induct <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemmas</span></span> le_Ord2 <span class="main">=</span> lt_ord2 <span class="main">[</span><span class="operator">THEN</span> succ_ordD<span class="main">]</span>
<span class="comment1">(* i&lt;0 ==&gt; R *)</span>
<span class="keyword1"><span class="command">lemmas</span></span> lt0E <span class="main">=</span> zero_def <span class="main">[</span><span class="operator">THEN</span> notE<span class="main">,</span> <span class="operator">elim</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_trans_pure <span class="main">[</span><span class="operator">trans</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span> <span class="main">;</span> <span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">k</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_asym <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span><span class="main">;</span> <span class="main">¬</span> <span class="free">P</span> <span class="main">⟹</span> <span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_notsym <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_irrefl <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_asym<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_not_refl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> lt_irrefl <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">leq</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‹<span class="keyword1">≤</span>›</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">≤</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">&lt;</span></span> <span class="free">succ</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> le_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">&lt;-&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">|</span> <span class="main">(</span><span class="free">i</span><span class="main">=</span><span class="free">j</span> <span class="main">&amp;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">succ</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord succ_ordD  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span> <span class="main">∨</span> <span class="main">(</span><span class="free">i</span> <span class="main">=</span> <span class="free">j</span> <span class="main">∧</span> <span class="free">Ord</span> <span class="free">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span> <span class="main">∨</span> <span class="free">i</span> <span class="main">=</span> <span class="free">j</span> <span class="main">∧</span> <span class="free">Ord</span> <span class="free">j</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_def lt_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> leI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> le_eqI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span><span class="main">=</span><span class="free">j</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> le_refl <span class="main">=</span> refl <span class="main">[</span><span class="operator">THEN</span> le_eqI<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> le_refl_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">i</span> <span class="main">&lt;-&gt;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm_simp</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lt_not_refl le_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> leCI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">~</span> <span class="main">(</span><span class="free">i</span><span class="main">=</span><span class="free">j</span> <span class="main">&amp;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> leE<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span><span class="main">;</span>  <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">;</span>  <span class="main">[|</span> <span class="free">i</span><span class="main">=</span><span class="free">j</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> le_anti_sym<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span><span class="main">;</span>  <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main">=</span><span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> lt_asym<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> le0_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="main"><span class="free">0</span></span> <span class="main">⟷</span> <span class="free">i</span><span class="main">=</span><span class="main"><span class="free">0</span></span>"</span></span>
 <span class="keyword1"><span class="command">using</span></span> zero_ord <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> leE<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> le0D <span class="main">=</span> le0_iff <span class="main">[</span><span class="operator">THEN</span> iffD1<span class="main">,</span> <span class="operator">dest</span><span class="main"><span class="main">!</span></span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_linear_lt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">j</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="main">(</span>lt<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span>"</span></span> <span class="main">|</span> <span class="main">(</span>eq<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">=</span><span class="free">j</span>"</span></span> <span class="main">|</span> <span class="main">(</span>gt<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms lt_linear <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_linear2<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> o<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span>"</span></span>
 <span class="keyword2"><span class="keyword">obtains</span></span> <span class="main">(</span>lt<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span>"</span></span> <span class="main">|</span> <span class="main">(</span>ge<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> i <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">i</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> j <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">j</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Ord_linear_lt<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> leI le_eqI sym o<span class="main">)</span> <span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_linear_le<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> o<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span>"</span></span>
 <span class="keyword2"><span class="keyword">obtains</span></span> <span class="main">(</span>le<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span> <span class="main">|</span> <span class="main">(</span>ge<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> i <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">i</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> j <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">j</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Ord_linear_lt<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> leI le_eqI o<span class="main">)</span> <span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> le_imp_not_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">≤</span> <span class="free">i</span> <span class="main">==&gt;</span> <span class="main">~</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> leE <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> lt_asym<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> not_lt_imp_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="main">~</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> i <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">i</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">and</span></span></span> j <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="free">j</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> Ord_linear2<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> not_lt_iff_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="main">~</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">&lt;-&gt;</span> <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> le_imp_not_lt not_lt_imp_le<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> not_le_iff_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="main">~</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">&lt;-&gt;</span> <span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">use</span> not_lt_iff_le <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span> 
    <span class="comment1">(*Proof edited. WAS: (simp (no_asm_simp) add: not_lt_iff_le [THEN iff_sym]) *)</span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_0_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="main"><span class="free">0</span></span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> not_lt_iff_le <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> iffD1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_0_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">i</span><span class="main">≠</span><span class="main"><span class="free">0</span></span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="main"><span class="free">0</span></span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">erule</span> not_le_iff_lt <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> iffD1<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> zero_ord<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> Ord_0_lt_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main">≠</span><span class="main"><span class="free">0</span></span> <span class="main">&lt;-&gt;</span> <span class="main"><span class="free">0</span></span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Ord_0_lt<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> all_lt_imp_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span><span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">==&gt;</span> <span class="bound">x</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> not_lt_imp_le <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> lt_irrefl<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_trans1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span><span class="main">;</span>  <span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">k</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> leE <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_trans_pure<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_trans2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span><span class="main">;</span>  <span class="free">j</span> <span class="main">≤</span> <span class="free">k</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> leE <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_trans_pure<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> le_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span><span class="main">;</span>  <span class="free">j</span> <span class="main">≤</span> <span class="free">k</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_trans1<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> succ_leI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span> <span class="main">==&gt;</span> <span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> not_lt_iff_le <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> iffD1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="main">(</span><span class="free">succ</span> <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_ord <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">i</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">j</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> leE lt_asym<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> succ_leE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> not_le_iff_lt <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> iffD1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">succ</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">succ</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord succ_ordD <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">succ</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">j</span> <span class="main">≤</span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> leE lt_asym<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="comment1">(*WAS: 
apply (rule not_le_iff_lt [THEN iffD1])
apply (blast elim: ltE leE lt_asym)+
done *)</span>


<span class="keyword1"><span class="command">lemma</span></span> succ_le_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">&lt;-&gt;</span> <span class="free">i</span><span class="main"><span class="free">&lt;</span></span><span class="free">j</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> succ_leI succ_leE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> succ_le_imp_le<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">≤</span> <span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> lt_imp_0_lt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">==&gt;</span> <span class="main"><span class="free">0</span></span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_trans1 Ord_0_le <span class="main"><span class="main">[</span></span><span class="operator">OF</span> lt_ord1<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> le_succ_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">≤</span> <span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">&lt;-&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span> <span class="main">|</span> <span class="free">i</span><span class="main">=</span><span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">&amp;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_iff<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> limit_ord<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> limit_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: 
apply (unfold Limit_def)
apply (erule conjunct1)
done *)</span>  

<span class="keyword1"><span class="command">lemma</span></span> Limit_has_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> limit_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS:
apply (unfold Limit_def)
apply (erule conjunct2 [THEN conjunct1])
done *)</span>  

<span class="keyword1"><span class="command">lemma</span></span> Limit_nonzero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≠</span> <span class="main"><span class="free">0</span></span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">drule</span> Limit_has_0<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Limit_has_succ<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> limit_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Limit_succ_lt_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span> <span class="main">&lt;-&gt;</span> <span class="main">(</span><span class="free">j</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">succ</span> <span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">succ</span> <span class="free">j</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_ord succ_lt <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lt_trans_pure <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">succ</span> <span class="free">j</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Limit_has_succ<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="comment1">(*WAS: 
apply (safe intro!: Limit_has_succ)
apply (frule lt_ord)
apply (blast intro: lt_trans)
done*)</span>

<span class="keyword1"><span class="command">lemma</span></span> zero_not_Limit <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">~</span> <span class="free">Limit</span><span class="main">(</span><span class="main"><span class="free">0</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> limit_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by (simp add: Limit_def)*)</span>

<span class="keyword1"><span class="command">lemma</span></span> Limit_has_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="main">1</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span>
 <span class="keyword1"><span class="command">unfolding</span></span> one_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Limit_has_0 Limit_has_succ<span class="main">)</span>
<span class="comment1">(*WAS: by (blast intro: Limit_has_0 Limit_has_succ) *)</span>

<span class="keyword1"><span class="command">lemma</span></span> increasing_LimitI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="main"><span class="free">0</span></span><span class="main"><span class="free">&lt;</span></span><span class="free">l</span><span class="main">;</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">l</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">l</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">y</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Limit</span><span class="main">(</span><span class="free">l</span><span class="main">)</span>"</span></span>
<span class="comment1">(*WAS: "[| 0&lt;l; ∀x∈l. ∃y∈l. x&lt;y |] ==&gt; Limit(l)"*)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> limit_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lt_ord2<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lt_trans1 lt_ord2<span class="main">)</span>
<span class="comment1">(*WAS: apply (unfold Limit_def, simp add: lt_ord2, clarify)
apply (drule_tac i=y in ltD)
apply (blast intro: lt_trans1 [OF _ ltI] lt_ord2)
done*)</span>


<span class="keyword1"><span class="command">lemma</span></span> non_succ_LimitI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">0</span></span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> nsucc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="free">succ</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span> <span class="main">≠</span> <span class="free">i</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> Oi<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> i <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lt_ord2<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> yi<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="free">&lt;</span></span><span class="free">i</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> Osy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">succ</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lt_ord succ_ord<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">~</span> <span class="free">i</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> yi <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> le_imp_not_lt<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">succ</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main"><span class="free">&lt;</span></span> <span class="free">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nsucc <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">y</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Ord_linear_lt <span class="main"><span class="main">[</span></span><span class="operator">OF</span> Osy Oi<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> i Oi <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> limit_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> succ_LimitE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> lt_irrefl<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> Limit_has_succ<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">erule</span> limit_ord <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> succ_ordD<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> le_refl<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> not_succ_Limit <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">~</span> <span class="free">Limit</span><span class="main">(</span><span class="free">succ</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> Limit_le_succD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>  <span class="free">i</span> <span class="main">≤</span> <span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">i</span> <span class="main">≤</span> <span class="free">j</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> leE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ord_cases_disj<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">i</span><span class="main">=</span><span class="main"><span class="free">0</span></span> <span class="main">|</span> <span class="main">(</span><span class="main">∃</span><span class="bound">j</span><span class="main">.</span> <span class="free">Ord</span><span class="main">(</span><span class="bound">j</span><span class="main">)</span> <span class="main">&amp;</span> <span class="free">i</span><span class="main">=</span><span class="free">succ</span><span class="main">(</span><span class="bound">j</span><span class="main">)</span><span class="main">)</span> <span class="main">|</span> <span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> non_succ_LimitI Ord_0_lt<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ord_cases<span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
 <span class="keyword2"><span class="keyword">obtains</span></span> <span class="main">(</span><span class="quoted">"0"</span><span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">=</span><span class="main"><span class="free">0</span></span>"</span></span> <span class="main">|</span> <span class="main">(</span>succ<span class="main">)</span> <span class="free">j</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">j</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">=</span><span class="free">succ</span><span class="main">(</span><span class="free">j</span><span class="main">)</span>"</span></span> <span class="main">|</span> <span class="main">(</span>limit<span class="main">)</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">insert</span> ord_cases_disj <span class="main"><span class="main">[</span></span><span class="operator">OF</span> i<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> trans_induct3_raw<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span><span class="main">;</span>
         <span class="free">P</span><span class="main">(</span><span class="main"><span class="free">0</span></span><span class="main">)</span><span class="main">;</span>
         <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="main">[|</span> <span class="free">Ord</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">;</span>  <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="free">succ</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
         <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="main">[|</span> <span class="free">Limit</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">;</span>  <span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">x</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>
      <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">erule</span> trans_induct<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">erule</span> ord_cases<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> trans_induct3 <span class="main">[</span><span class="operator">case_names</span> 0 succ limit<span class="main">,</span> <span class="operator">consumes</span> 1<span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main"><span class="free">0</span></span><span class="main">)</span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">Ord</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span><span class="free">succ</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="free">Limit</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">&lt;</span></span> <span class="bound">x</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> trans_induct3_raw <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">i</span></span> <span class="quoted"><span class="free">P</span></span><span class="main">,</span> <span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 

<span class="comment1">(*Needs to come before the locale specification of Ops *)</span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">setseq</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">setseq</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span> rall <span class="main">(</span><span class="main">λ</span><span class="bound">β</span><span class="main">.</span> <span class="bound">β</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">ω</span></span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="bound">β</span><span class="main">.</span> <span class="free">Set</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="bound">β</span><span class="main">)</span><span class="main">)</span>"</span></span>


<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span>






    </pre>
</body>

</html>