<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory GZF_locale</title>
</head>


<body>
<div class="head">
<h1>Theory GZF_locale</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> GZF_locale
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a> <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">no_notation</span></span> Set.member <span class="main">(</span><span class="quoted">"<span class="keyword1">'(‚àà')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> 
            Set.member <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">‚àà</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            Set.not_member  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(‚àâ')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            Set.not_member  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚àâ</span>‚Ä∫</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            Set.not_member  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">‚àâ</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            subset_eq  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(‚äÜ')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            subset_eq  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">‚äÜ</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            Union <span class="main">(</span><span class="quoted">"<span class="keyword1">‚ãÉ</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> Inter <span class="main">(</span><span class="quoted">"<span class="keyword1">‚ãÇ</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            union <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">‚à™</span>"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> inter <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">‚à©</span>"</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
            image <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">`</span>"</span> 90<span class="main">)</span>

<span class="keyword1"><span class="command">no_notation</span></span> Product_Type.Times <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">√ó</span>"</span> 80<span class="main">)</span>

<span class="keyword1"><span class="command">no_notation</span></span> less_eq  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(‚â§')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  less_eq  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">‚â§</span> _<span class="keyword3">)</span>"</span>  <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  less  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(&lt;')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  less  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">&lt;</span> _<span class="keyword3">)</span>"</span>  <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span>

<span class="keyword1"><span class="command">no_notation</span></span> 
  Groups.minus <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">-</span>"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> 
  Groups.zero <span class="main">(</span><span class="quoted">"<span class="keyword1">0</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> 
  Groups.one_class.one <span class="main">(</span><span class="quoted">"<span class="keyword1">1</span>"</span><span class="main">)</span>

<span class="keyword1"><span class="command">no_notation</span></span> <span class="main">(</span>ASCII<span class="main">)</span>
  Set.member  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(:')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Set.member  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">:</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Set.not_member  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(~:')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Set.not_member  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">~:</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  less_eq  <span class="main">(</span><span class="quoted">"<span class="keyword1">'(&lt;=')</span>"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  less_eq  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_<span class="keyword3">/ </span><span class="keyword1">&lt;=</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>51<span class="main">,</span> 51<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  union <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">Un</span>"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  inter <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">Int</span>"</span> 70<span class="main">)</span>

<span class="keyword1"><span class="command">notation</span></span> <span class="main">(</span>ASCII<span class="main">)</span>
  not_equal  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">~=</span>‚Ä∫</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Not  <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">~</span> _‚Ä∫</span> <span class="main">[</span>40<span class="main">]</span> 40<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  conj  <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‚Äπ<span class="keyword1">&amp;</span>‚Ä∫</span> 35<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  disj  <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‚Äπ<span class="keyword1">|</span>‚Ä∫</span> 30<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  All  <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">‚Äπ<span class="keyword1">ALL</span> ‚Ä∫</span> 10<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Ex  <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">‚Äπ<span class="keyword1">EX</span> ‚Ä∫</span> 10<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  Ex1  <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">‚Äπ<span class="keyword1">EX!</span> ‚Ä∫</span> 10<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  implies  <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‚Äπ<span class="keyword1">--&gt;</span>‚Ä∫</span> 25<span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span>
  iff  <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‚Äπ<span class="keyword1">&lt;-&gt;</span>‚Ä∫</span> 25<span class="main">)</span>

<span class="comment1">(*Removing list syntax so that we can have f[x] := image(f,x) *)</span>
<span class="keyword1"><span class="command">no_translations</span></span>
  <span class="quoted">"<span class="main">[</span><span class="free">x</span><span class="main">,</span> <span class="free">xs</span><span class="main">]</span>"</span> <span class="main">==</span> <span class="quoted">"<span class="free">x</span><span class="main">#</span><span class="main">[</span><span class="free">xs</span><span class="main">]</span>"</span>
  <span class="quoted">"<span class="main">[</span><span class="free">x</span><span class="main">]</span>"</span> <span class="main">==</span> <span class="quoted">"<span class="free">x</span><span class="main">#</span><span class="main">[]</span>"</span>
<span class="keyword1"><span class="command">no_syntax</span></span>
  <span class="quoted">"_list"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"args <span class="main">=&gt;</span> <span class="tfree">'a</span> list"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">[</span><span class="keyword3">(</span>_<span class="keyword3">)</span><span class="keyword1">]</span>"</span><span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> GZF <span class="main">=</span>  <span class="comment1">(*Fixes and axiomatises constants on type 'd*)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Mem</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚àà</span>‚Ä∫</span> 50<span class="main">)</span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Emp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span>  <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚àÖ</span>‚Ä∫</span><span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span>            
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚ãÉ</span> _‚Ä∫</span> <span class="main">[</span>90<span class="main">]</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Subset</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚äÜ</span>‚Ä∫</span> 50<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pow</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">ùí´</span> _‚Ä∫</span> <span class="main">[</span>90<span class="main">]</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Succ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Inf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Repl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool<span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span><span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚Ñõ</span>‚Ä∫</span> 90<span class="main">)</span> 
 <span class="keyword2"><span class="keyword">assumes</span></span> emp <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="main">~</span> <span class="main">(</span><span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="bound">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚à®</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> ext <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="free">Set</span> <span class="bound">y</span> <span class="main">‚ü∂</span> 
      <span class="main">(</span><span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span> <span class="main">‚ü∂</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> subset_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="bound">y</span> <span class="main">‚ü∑</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="free">Set</span> <span class="bound">y</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> uni <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="main">(</span><span class="free">Set</span> <span class="main">(</span><span class="main"><span class="free">‚ãÉ</span></span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> pow <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="bound">z</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> suc <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Succ</span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚à®</span> <span class="bound">a</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> inf <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span> <span class="main">‚ü∂</span> <span class="free">Succ</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> repl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">P</span> <span class="bound">x</span><span class="main">.</span> <span class="free">Set</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="free">Set</span> <span class="main">(</span><span class="free">Repl</span> <span class="bound">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚àß</span> 
             <span class="main">(</span><span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="main">(</span><span class="main">‚àÉ<span class="hidden">‚á©</span><sub>‚â§</sub><span class="hidden">‚á©</span><sub>1</sub></span> <span class="bound">b</span><span class="main">.</span> <span class="bound">P</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span>
         <span class="main">‚ü∂</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">b</span><span class="main">.</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">(</span><span class="free">Repl</span> <span class="bound">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="bound">P</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 

<span class="keyword1"><span class="command">context</span></span> GZF <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">the_default</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">Œπ''</span> _ _‚Ä∫</span> <span class="main">[</span>90<span class="main">,</span>90<span class="main">]</span> <span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">Œπ'</span></span> <span class="free"><span class="bound"><span class="entity">d</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">‚â°</span> <span class="keyword1">if</span> Ex1 <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="keyword1">then</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="bound">x</span><span class="main">)</span> <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">d</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> the_def_if <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span>Ex1 <span class="free">F</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">F</span> <span class="free">a</span> <span class="main">‚ü∑</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span> 
                               <span class="keyword1">else</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‚ÄπEx1 <span class="free">F</span>‚Ä∫</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Ex1 <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">x</span><span class="main">.</span> <span class="free">F</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> the_default_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="free">a</span> <span class="main">‚ü∑</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="free">a</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> eq<span class="main"><span class="keyword3">,</span></span> <span class="operator">insert</span> <span class="quoted"><span class="quoted">‚ÄπEx1 <span class="free">F</span>‚Ä∫</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq <span class="quoted"><span class="quoted">‚ÄπEx1 <span class="free">F</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> theI<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span>Ex1 <span class="free">F</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">F</span> <span class="free">a</span> <span class="main">‚ü∑</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚ÄπEx1 <span class="free">F</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬¨</span> Ex1 <span class="free">F</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">if</span> <span class="main">(</span>Ex1 <span class="free">F</span><span class="main">)</span> <span class="keyword1">then</span> <span class="main">(</span><span class="free">F</span> <span class="free">a</span> <span class="main">‚ü∑</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span> <span class="keyword1">else</span> <span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">F</span> <span class="main">=</span> <span class="free">d</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> the_default_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> the_def_eq <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚üπ</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Ex1 <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">a</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> the_def_if <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">P</span> <span class="free">a</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> the_defI <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚üπ</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> the_def_eq assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">P</span> <span class="free">a</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> the_defI' <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Ex1 <span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> the_defI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> the_defI2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚üπ</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚üπ</span> <span class="free">Q</span> <span class="bound">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> assms the_defI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> the_defI2' <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Ex1 <span class="free">P</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚üπ</span> <span class="free">Q</span> <span class="bound">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> the_defI2<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> P<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free">P</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> Q<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free">Q</span></span><span class="main"><span class="main">]</span></span> ex1E<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">(</span></span></span>1<span class="main"><span class="main"><span class="main">)</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> the_def_eq' <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> Ex1 <span class="free">P</span> <span class="main">;</span> <span class="free">P</span> <span class="free">a</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="keyword1">Œπ'</span> <span class="free">d</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> the_def_eq<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRestricted quantification using a predicate‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rall</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  rall_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">rall</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">‚â°</span> <span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="bound">x</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rex</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  rex_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">rex</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">‚â°</span> <span class="main">‚àÉ</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="bound">x</span>"</span></span>

<span class="comment1">(*Taken from ZF/OrdQuant, unfolded syntax*)</span>
<span class="keyword1"><span class="command">lemma</span></span> rallI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> rall <span class="free">M</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rspec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> rall <span class="free">M</span> <span class="free">P</span><span class="main">;</span> <span class="free">M</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_rallE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> rall <span class="free">M</span> <span class="free">P</span><span class="main">;</span>  <span class="main">~</span> <span class="free">M</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Q</span><span class="main">;</span>  <span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rallE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> rall <span class="free">M</span> <span class="free">P</span><span class="main">;</span> <span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Q</span><span class="main">;</span>  <span class="main">~</span> <span class="free">M</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> rall_triv <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rall <span class="free">M</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">(</span><span class="main">‚àÉ</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚ü∂</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rall_cong <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">&lt;-&gt;</span> <span class="free">P'</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="main">(</span>rall <span class="free">M</span> <span class="free">P</span><span class="main">)</span> <span class="main">&lt;-&gt;</span> <span class="main">(</span>rall <span class="free">M</span> <span class="free">P'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rexI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">;</span> <span class="free">M</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> rex <span class="free">M</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rex_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_rexI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">M</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">;</span>  <span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> rex <span class="free">M</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> rexCI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> rall <span class="free">M</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="main">~</span><span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">;</span> <span class="free">M</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> rex <span class="free">M</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> rexE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> rex <span class="free">M</span> <span class="free">P</span><span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="main">[|</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rex_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rex_triv <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rex <span class="free">M</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">(</span><span class="main">‚àÉ</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rex_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rex_cong <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">&lt;-&gt;</span> <span class="free">P'</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="main">(</span>rex <span class="free">M</span> <span class="free">P</span><span class="main">)</span> <span class="main">&lt;-&gt;</span> <span class="main">(</span>rex <span class="free">M</span> <span class="free">P'</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rex_def <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> conj_cong<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> atomize_rall<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="free">M</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">==</span> Trueprop <span class="main">(</span>rall <span class="free">M</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rall_def atomize_all atomize_imp<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπBounding quantification over a set‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ball</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  ball_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ball</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> rall <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">bex</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  bex_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">bex</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> rex <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">not_mem</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚àâ</span>‚Ä∫</span> 50<span class="main">)</span>  <span class="comment1">‚Äï ‚Äπnegated membership relation‚Ä∫</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚àâ</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> <span class="main">¬¨</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="comment1">(*Lemmas taken from ZF/ZF_Base*)</span>
<span class="keyword1"><span class="command">lemma</span></span> ballI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">‚ãÄ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">A</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚üπ</span> ball <span class="free">A</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ball_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bspec <span class="main">[</span><span class="operator">dest</span><span class="main"><span class="main"><span class="main">?</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> ball <span class="free">A</span> <span class="free">P</span><span class="main">;</span>  <span class="free">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> ball_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_ballE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> ball <span class="free">A</span> <span class="free">P</span><span class="main">;</span>  <span class="free">x</span><span class="main">‚àâ</span><span class="free">A</span> <span class="main">==&gt;</span> <span class="free">Q</span><span class="main">;</span>  <span class="free">P</span> <span class="free">x</span> <span class="main">==&gt;</span> <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ball_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ballE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> ball <span class="free">A</span> <span class="free">P</span><span class="main">;</span>  <span class="free">P</span> <span class="free">x</span> <span class="main">==&gt;</span> <span class="free">Q</span><span class="main">;</span>  <span class="free">x</span><span class="main">‚àâ</span><span class="free">A</span> <span class="main">‚üπ</span>  <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> ball_triv <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"ball <span class="free">A</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">(</span><span class="main">‚àÉ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">)</span> <span class="main">‚ü∂</span> <span class="free">P</span><span class="main">)</span>"</span></span>
 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ball_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> ball_cong <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span><span class="main">=</span><span class="free">A'</span><span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A'</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="free">P'</span> <span class="bound">x</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="main">(</span>ball <span class="free">A</span> <span class="free">P</span> <span class="main">‚ü∑</span> ball <span class="free">A'</span> <span class="free">P'</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ball_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bexI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">P</span> <span class="free">x</span><span class="main">;</span>  <span class="free">x</span><span class="main"><span class="free">‚àà</span></span> <span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span> bex <span class="free">A</span> <span class="free">P</span> "</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bex_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_bexI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">;</span>  <span class="free">P</span> <span class="free">x</span> <span class="main">|]</span> <span class="main">==&gt;</span>  bex <span class="free">A</span> <span class="free">P</span> "</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bexCI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> ball <span class="free">A</span>  <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="main">~</span><span class="free">P</span> <span class="bound">x</span><span class="main">)</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="free">a</span><span class="main">;</span>  <span class="free">a</span><span class="main"><span class="free">‚àà</span></span> <span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span>  bex <span class="free">A</span> <span class="free">P</span> "</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> bexE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">[|</span>  bex <span class="free">A</span> <span class="free">P</span> <span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="main">[|</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">;</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">Q</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bex_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bex_triv <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"bex <span class="free">A</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free">P</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">(</span><span class="main">‚àÉ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">)</span> <span class="main">&amp;</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bex_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> bex_cong <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span><span class="main">=</span><span class="free">A'</span><span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A'</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="bound">x</span> <span class="main">‚ü∑</span> <span class="free">P'</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">|]</span>
     <span class="main">==&gt;</span>  bex <span class="free">A</span> <span class="free">P</span> <span class="main">‚ü∑</span> bex <span class="free">A'</span> <span class="free">P'</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> bex_def <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> conj_cong<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for the Set ownership relation‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> set_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚à®</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> set <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> setI  <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> set_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> setE  <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚à®</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> set_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for the subset relation‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> subset_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="free">Set</span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">Set</span> <span class="free">y</span> <span class="main">‚àß</span> <span class="main">(</span>ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> subset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> subset_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> subset_set1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> subset_set2 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(*Lemmas taken from ZF/ZF_Base:*)</span>

<span class="comment1">(*Added assumptions ‚ÄπSet A‚Ä∫, ‚ÄπSet B‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> subsetI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span> <span class="main">==&gt;</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">B</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms subset_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by (simp add: subset_def) *)</span>

<span class="keyword1"><span class="command">lemma</span></span> subsetD <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span>  <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> subset_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: apply (unfold subset_def)
       apply (erule bspec, assumption)
       done
*)</span>
<span class="keyword1"><span class="command">lemma</span></span> subsetCE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span>  <span class="free">c</span><span class="main">‚àâ</span><span class="free">A</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">;</span>  <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">B</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> subsetD <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by (simp add: subset_def, blast)*)</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_subsetD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">;</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> contra_subsetD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span> <span class="free">c</span> <span class="main">‚àâ</span> <span class="free">B</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">c</span> <span class="main">‚àâ</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> rev_contra_subsetD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">c</span> <span class="main">‚àâ</span> <span class="free">B</span><span class="main">;</span>  <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">c</span> <span class="main">‚àâ</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">(*Added assumption: ‚ÄπSet A‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> subset_refl <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">A</span>"</span></span>
 <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="comment1">(*WAS: by blast*)</span>

<span class="keyword1"><span class="command">lemma</span></span> subset_trans<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span>  <span class="free">B</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">C</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subset_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="comment1">(*WAS: by blast*)</span>

<span class="keyword1"><span class="command">declare</span></span> subsetD <span class="main">[</span><span class="operator">trans</span><span class="main">]</span> rev_subsetD <span class="main">[</span><span class="operator">trans</span><span class="main">]</span> subset_trans <span class="main">[</span><span class="operator">trans</span><span class="main">]</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπEquality of sets‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> subset_equal <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚àß</span> <span class="free">y</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">x</span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ext <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> equality_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ext <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(*Lemmas taken from ZF/ZF_Base:*)</span>
<span class="keyword1"><span class="command">lemma</span></span> equalityI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span>  <span class="free">B</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> subset_set subset_equal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by (rule extension [THEN iffD2], rule conjI) *)</span>

<span class="comment1">(*Added assumptions: ‚ÄπSet A‚Ä∫ ‚ÄπSet B‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> equality_iffI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">B</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">A</span> <span class="main">‚ü∑</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">B</span><span class="main">)</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms equalityI subsetI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">(*WAS: by (rule equalityI, blast+)*)</span>

<span class="comment1">(*Replaced ‚Äπextension‚Ä∫ with ‚Äπsubset_equal‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemmas</span></span> equalityD1 <span class="main">=</span> subset_equal <span class="main">[</span><span class="operator">THEN</span> iffD1<span class="main">,</span> <span class="operator">THEN</span> conjunct1<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> equalityD2 <span class="main">=</span> subset_equal <span class="main">[</span><span class="operator">THEN</span> iffD1<span class="main">,</span> <span class="operator">THEN</span> conjunct2<span class="main">]</span>

<span class="comment1">(*Added assumptions: ‚ÄπSet A‚Ä∫ ‚ÄπSet B‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> equalityE<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span><span class="main">;</span>  <span class="main">[|</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span><span class="main">;</span> <span class="free">B</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">A</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="main">|]</span>  <span class="main">==&gt;</span>  <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">use</span> equalityD1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span> equalityD2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="comment1">(*WAS: by (blast dest: equalityD1 equalityD2) *)</span>

<span class="comment1">(*Added assumptions: ‚ÄπSet A‚Ä∫ ‚ÄπSet B‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> equalityCE<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span><span class="main">;</span>  <span class="main">[|</span> <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span><span class="main">;</span> <span class="free">c</span><span class="main"><span class="free">‚àà</span></span><span class="free">B</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span><span class="main">;</span>  <span class="main">[|</span> <span class="free">c</span><span class="main">‚àâ</span><span class="free">A</span><span class="main">;</span> <span class="free">c</span><span class="main">‚àâ</span><span class="free">B</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">P</span> <span class="main">|]</span>  <span class="main">==&gt;</span>  <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> equalityE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="comment1">(*WAS: by (erule equalityE, blast)*)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚ÄπRules for the empty set‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> emp_set <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> set_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(*Taken from ZF/ZF_Base*)</span>
<span class="keyword1"><span class="command">lemma</span></span> not_mem_empty <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚àâ</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> emp<span class="main">)</span>
<span class="comment1">(*WAS: apply (cut_tac foundation)
       apply (best dest: equalityD2)
       done *)</span>

<span class="keyword1"><span class="command">lemmas</span></span> emptyE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span> <span class="main">=</span> not_mem_empty <span class="main">[</span><span class="operator">THEN</span> notE<span class="main">]</span>

<span class="comment1">(*Added assumption: ‚ÄπSet A‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> empty_subsetI <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by blast*)</span>

<span class="comment1">(*Added assumption: ‚ÄπSet A‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> equals0I<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">[|</span><span class="main">!!</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span> <span class="main">==&gt;</span> False <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">A</span><span class="main">=</span><span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iffI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms emp_set<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> not_mem_empty <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="comment1">(*WAS: by blast*)</span>

<span class="keyword1"><span class="command">lemma</span></span> equals0D <span class="main">[</span><span class="operator">dest</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">declare</span></span> sym <span class="main">[</span><span class="operator">THEN</span> equals0D<span class="main">,</span> <span class="operator">dest</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> not_emptyI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">==&gt;</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">(*Added assumption: ‚ÄπSet A‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> not_emptyE<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">A</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">A</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">;</span>  <span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">‚àà</span></span><span class="free">A</span> <span class="main">==&gt;</span> <span class="free">R</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setE<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="comment1">(*WAS: by blast*)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπCorollaries of the Axiom of Union‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> union_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span><span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> uni <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(*Added assumption: ‚ÄπSet x‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> union_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms uni <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: axiomatised then, declare union_iff [simp]*)</span>

<span class="comment1">(*Added assumption: ‚ÄπSet x‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> unionI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">;</span>  <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> union_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="comment1">(*WAS: by (simp, blast)*)</span>

<span class="comment1">(*Added assumption: ‚ÄπSet x‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> unionE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span><span class="main">;</span>  <span class="main">‚ãÄ</span><span class="bound">y</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">;</span>  <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> union_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>
<span class="comment1">(*WAS: by (simp, blast)*)</span>

<span class="keyword1"><span class="command">lemma</span></span> union_emp <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms unionE not_emptyI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for power sets‚Ä∫</span></span>

<span class="comment1">(*Added assumption: ‚ÄπSet x‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> pow_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">y</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> pow assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: an axiom*)</span>

<span class="comment1">(*Added assumption: ‚ÄπSet x‚Ä∫*)</span>
<span class="keyword1"><span class="command">lemma</span></span> powI<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> subset_set2 pow_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="comment1">(*WAS: by (erule Pow_iff [THEN iffD2])*)</span>

<span class="keyword1"><span class="command">lemma</span></span> powD<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="free">B</span> <span class="main">‚üπ</span> <span class="free">A</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> pow_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="comment1">(*WAS: by (erule Pow_iff [THEN iffD1]) *)</span>

<span class="keyword1"><span class="command">declare</span></span> pow_iff 

<span class="keyword1"><span class="command">lemmas</span></span> pow_bottom <span class="main">=</span> empty_subsetI <span class="main">[</span><span class="operator">THEN</span> powI<span class="main">]</span>    <span class="comment1">‚Äï ‚Äπ<span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span><span class="quoted">‚Äπ<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="free">B</span>‚Ä∫</span></span>‚Ä∫</span>
<span class="keyword1"><span class="command">lemmas</span></span> pow_top <span class="main">=</span> subset_refl <span class="main">[</span><span class="operator">THEN</span> powI<span class="main">]</span>         <span class="comment1">‚Äï ‚Äπ<span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">term</span><span class="hidden">&gt;</span></span><span class="quoted">‚Äπ<span class="free">A</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="free">A</span>‚Ä∫</span></span>‚Ä∫</span>

<span class="keyword1"><span class="command">lemma</span></span> pow_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI<span class="main">[</span><span class="operator">OF</span> pow_top<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for von Neumann successor operation‚Ä∫</span></span>

<span class="keyword1"><span class="command">thm</span></span> suc
<span class="keyword1"><span class="command">lemma</span></span> vsucc_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Succ</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">|</span> <span class="free">y</span> <span class="main">=</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms suc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> vsuccI1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Succ</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vsucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> vsuccI2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Succ</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vsucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> vsucc_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span><span class="free">Succ</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> setI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> vsuccI2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> vsuccE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Succ</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">|</span> <span class="free">y</span> <span class="main">=</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vsucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for the witness of Axiom of Infinity‚Ä∫</span></span>

<span class="keyword1"><span class="command">thm</span></span> inf
<span class="keyword1"><span class="command">lemma</span></span> inf0 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> inf_closed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span> <span class="main">‚üπ</span> <span class="free">Succ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Inf</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> inf_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">Inf</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> setI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> inf0<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπRules for Replacement and derived operators‚Ä∫</span></span>

<span class="keyword1"><span class="command">thm</span></span> repl
<span class="keyword1"><span class="command">lemma</span></span> repl_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span><span class="free">Repl</span> <span class="free">P</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> repl <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> repl_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚àÉ<span class="hidden">‚á©</span><sub>‚â§</sub><span class="hidden">‚á©</span><sub>1</sub></span> <span class="bound">b</span><span class="main">.</span> <span class="free">P</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Repl</span> <span class="free">P</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">P</span> <span class="bound">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> repl assms <span class="keyword1"><span class="command">unfolding</span></span> ball_def rall_def bex_def rex_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Replace</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool<span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Replace</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="free">Repl</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ!</span><span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> replace_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>Replace <span class="free">P</span> <span class="free">x</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Replace_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> repl_set<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> replace_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="free">P</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">P</span> <span class="bound">a</span> <span class="free">b</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">c</span><span class="main">.</span> <span class="free">P</span> <span class="bound">a</span> <span class="bound">c</span> <span class="main">‚ü∂</span> <span class="bound">c</span> <span class="main">=</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Q</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">Œª</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ!</span><span class="bound">z</span><span class="main">.</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">z</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">P</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚àÉ<span class="hidden">‚á©</span><sub>‚â§</sub><span class="hidden">‚á©</span><sub>1</sub></span> <span class="bound">b</span><span class="main">.</span> <span class="var">?Q</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Uniq_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Repl</span> <span class="var">?Q</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="var">?Q</span> <span class="bound">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> repl_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Replace_def Ex1_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> replaceI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">P</span> <span class="free">a</span> <span class="free">b</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">c</span><span class="main">.</span> <span class="free">P</span> <span class="free">a</span> <span class="bound">c</span> <span class="main">‚üπ</span> <span class="bound">c</span> <span class="main">=</span> <span class="free">b</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="free">P</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> replace_iff setI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> replaceE<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="free">P</span> <span class="free">x</span> <span class="main">;</span> 
          <span class="main">‚ãÄ</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚ü¶</span><span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">P</span> <span class="bound">a</span> <span class="free">b</span> <span class="main">;</span> <span class="main">‚àÄ</span><span class="bound">c</span><span class="main">.</span> <span class="free">P</span> <span class="bound">a</span> <span class="bound">c</span> <span class="main">‚ü∂</span> <span class="bound">c</span> <span class="main">=</span> <span class="free">b</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span> <span class="main">‚üß</span>
          <span class="main">‚üπ</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> replace_iff <span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> iffD1<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> bexE<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> replaceE2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="free">P</span> <span class="free">x</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚ü¶</span><span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">P</span> <span class="bound">a</span> <span class="free">b</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> replaceE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> replace_cong <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚ü∑</span> <span class="free">Q</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">‚üß</span> <span class="main">‚üπ</span> Replace <span class="free">P</span> <span class="free">x</span> <span class="main">=</span> Replace <span class="free">Q</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iffI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> replace_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> 
                            replace_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms replace_iff<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">RepFun</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">RepFun</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">b</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="bound">a</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> repfun_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>RepFun <span class="free">F</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> RepFun_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> replace_set<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> repfunI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span>  <span class="free">F</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> RepFun <span class="free">F</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> RepFun_def <span class="keyword1"><span class="command">using</span></span> replace_iff setI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> repfun_eqI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span><span class="free">b</span> <span class="main">=</span> <span class="free">F</span> <span class="free">a</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> RepFun <span class="free">F</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> repfunI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> repfunE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> RepFun <span class="free">F</span> <span class="free">x</span> <span class="main">;</span> 
        <span class="main">‚ãÄ</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">b</span> <span class="main">=</span> <span class="free">F</span> <span class="bound">a</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> RepFun_def replace_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> repfun_cong <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">F</span> <span class="bound">a</span> <span class="main">=</span> <span class="free">G</span> <span class="bound">a</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> RepFun <span class="free">F</span> <span class="free">x</span> <span class="main">=</span> RepFun <span class="free">G</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> RepFun_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> repfun_iff  <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> RepFun <span class="free">F</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">c</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="free">F</span> <span class="bound">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> repfun_eqI repfunE<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> repfun_union <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> RepFun <span class="free">F</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">F</span> <span class="bound">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> union_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> repfun_set<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span> bex_def rex_def
                repfun_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπSubset comprehension‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Collect</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Collect</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span> <span class="main">=</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">a</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> collect_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>Collect <span class="free">P</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Collect_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> replace_set<span class="main">)</span> 

<span class="keyword1"><span class="command">lemma</span></span> collect_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> Collect <span class="free">P</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">P</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Collect_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> replace_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 

<span class="keyword1"><span class="command">lemma</span></span> collectI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">P</span> <span class="free">a</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> Collect <span class="free">P</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI collect_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> collectE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> Collect <span class="free">P</span> <span class="free">x</span> <span class="main">;</span> <span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">P</span> <span class="free">a</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> collect_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> collectD1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> Collect <span class="free">P</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> collectE<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">lemma</span></span> collectD2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> Collect <span class="free">P</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> collectE<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> Collect_cong <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="main">[</span><span class="operator">cong</span><span class="main">]</span><span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span><span class="main">;</span>  <span class="main">‚ãÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="bound">a</span> <span class="main">‚ü∑</span> <span class="free">Q</span> <span class="bound">a</span> <span class="main">‚üß</span>
     <span class="main">‚üπ</span> Collect <span class="free">P</span> <span class="free">x</span> <span class="main">=</span> Collect <span class="free">Q</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Collect_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπIntersection of a set‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Int</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚ãÇ</span> _‚Ä∫</span> <span class="main">[</span>90<span class="main">]</span> 90<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚ãÇ</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> Collect <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> ball <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">Union</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span><span class="main">‚ãÇ</span> <span class="free">x</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> Int_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> collect_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> union_set<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Int_iff<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="main">(</span>ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Int_def
    <span class="keyword1"><span class="command">using</span></span> collectE<span class="main">[</span><span class="operator">OF</span> union_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> union_emp<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> ball<span class="main">:</span><span class="quoted"><span class="quoted">"ball <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span>‚Ä∫</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> not_emptyE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main"><span class="free">‚ãÉ</span></span> <span class="free">x</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ball unionI<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> ball_def rall_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Int_def <span class="keyword1"><span class="command">using</span></span> ball collectI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> IntI <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="main">‚ãÄ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">y</span> <span class="main">;</span> <span class="free">x</span> <span class="main">‚â†</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> IntD <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span> <span class="main">;</span> <span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI Int_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> IntE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚ãÇ</span> <span class="free">x</span> <span class="main">;</span> <span class="free">y</span> <span class="main">‚àâ</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">R</span><span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">R</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπSet difference‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">diff</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">-</span>‚Ä∫</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">-</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> Collect <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main">‚àâ</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> diff_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> diff_def <span class="keyword1"><span class="command">using</span></span> collect_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> diffI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">y</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI diff_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> diffD1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> diff_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">lemma</span></span> diffD2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> diff_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> diffE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ü¶</span><span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">y</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> diff_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπUnordered pairs; defined by replacement over ùí´ (ùí´ ‚àÖ)‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">œÜ</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">‚â°</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">‚à®</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">upair</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">upair</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> Replace <span class="main">(</span>œÜ <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="free">Emp</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> upair_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>upair <span class="free">a</span> <span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> upair_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> replace_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> pow_emp_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">‚ü∑</span> <span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pow_iff<span class="main">[</span><span class="operator">OF</span> emp_set<span class="main">]</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main">‚àâ</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> equals0I <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> empty_subsetI<span class="main">[</span><span class="operator">OF</span> emp_set<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> pow_pow_emp_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">|</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> pow_iff<span class="main">[</span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="comment1">(*and "‚àÄa. a ‚àà x ‚ü∂ a ‚àà ùí´ ‚àÖ" by auto*)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">|</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> setE<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">|</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> emp_x <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>‚Ä∫</span></span> pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iffI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>‚Ä∫</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>‚Ä∫</span></span> pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">|</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">|</span> <span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> empty_subsetI<span class="main">[</span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> subset_refl<span class="main">[</span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> œÜ_uniq <span class="main">:</span> <span class="quoted"><span class="quoted">"œÜ <span class="free">x</span> <span class="free">y</span> <span class="free">a</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">z</span><span class="main">.</span> œÜ <span class="free">x</span> <span class="free">y</span> <span class="free">a</span> <span class="bound">z</span> <span class="main">‚ü∂</span> <span class="bound">z</span> <span class="main">=</span> <span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">thm</span></span> replace_iff<span class="main">[</span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
<span class="keyword1"><span class="command">lemma</span></span> upair_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">x</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">b</span> <span class="main">=</span> <span class="free">x</span> <span class="main">|</span> <span class="free">b</span> <span class="main">=</span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> upair_def 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">erule</span> replaceE2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pow_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> emp_set<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"œÜ <span class="free">x</span> <span class="free">y</span> <span class="skolem">a</span> <span class="free">b</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">=</span> <span class="free">x</span> <span class="main">|</span> <span class="free">b</span> <span class="main">=</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pow_pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">=</span> <span class="free">x</span> <span class="main">|</span> <span class="free">b</span> <span class="main">=</span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span>œÜ <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span>œÜ <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> replaceI<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">b</span> <span class="main">=</span> <span class="free">x</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pow_pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">c</span><span class="main">.</span> œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="bound">c</span> <span class="main">‚üπ</span> <span class="bound">c</span> <span class="main">=</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> œÜ_uniq<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">`œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="free">b</span>`</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span>œÜ <span class="free">x</span> <span class="free">y</span><span class="main">)</span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> replaceI<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">b</span> <span class="main">=</span> <span class="free">y</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main"><span class="free">‚àà</span></span> <span class="keyword1"><span class="free">ùí´</span></span> <span class="main">(</span><span class="keyword1"><span class="free">ùí´</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pow_pow_emp_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ãÄ</span><span class="bound">c</span><span class="main">.</span> œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="bound">c</span> <span class="main">‚üπ</span> <span class="bound">c</span> <span class="main">=</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> œÜ_uniq<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">`œÜ <span class="free">x</span> <span class="free">y</span> <span class="var">?a</span> <span class="free">b</span>`</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> upairI1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">a</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> upair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">lemma</span></span> upairI2 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">a</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> upair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> upairE <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">b</span> <span class="free">c</span> <span class="main">;</span> <span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">;</span> <span class="free">a</span><span class="main">=</span><span class="free">c</span> <span class="main">‚üπ</span> <span class="free">P</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> upair_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπSingleton sets‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sng</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sng</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sng_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>sng <span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> sng_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> upair_set<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> sng_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> sng <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">a</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> sng_def <span class="keyword1"><span class="command">using</span></span> upair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> sngI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> sng <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sng_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> sngE <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> sng <span class="free">x</span> <span class="main">;</span> <span class="free">a</span> <span class="main">=</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sng_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπEquality for very small sets‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> sng_eq_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"sng <span class="free">a</span> <span class="main">=</span> sng <span class="free">b</span> <span class="main">‚ü∑</span> <span class="free">a</span><span class="main">=</span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> sng_set<span class="main"><span class="main">,</span></span> <span class="operator">OF</span> sng_set<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> cnf.iff_trans<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span>
      <span class="operator">use</span> sng_iff <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> upair_eq_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>upair <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>upair <span class="free">c</span> <span class="free">d</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span><span class="main">=</span><span class="free">d</span><span class="main">)</span> <span class="main">|</span> <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="free">d</span> <span class="main">‚àß</span> <span class="free">b</span><span class="main">=</span><span class="free">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> upair_set upair_set<span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> cnf.iff_trans<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">a</span> <span class="free">b</span> <span class="main">‚ü∑</span> <span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">c</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">b</span> <span class="main">|</span> <span class="free">a</span> <span class="main">‚â†</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚à®</span> <span class="free">a</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"upair <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> sng <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> sng_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">=</span> <span class="free">a</span> <span class="main">‚àß</span> <span class="free">d</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq upair_iff sng_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚à®</span> <span class="free">a</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">a</span> <span class="main">=</span> <span class="free">b</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">‚â†</span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">c</span> <span class="free">d</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">c</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq upairI1 upairI2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚à®</span> <span class="free">a</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">a</span><span class="main">‚â†</span><span class="free">b</span>‚Ä∫</span></span> upair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚à®</span> <span class="free">a</span> <span class="main">=</span> <span class="free">d</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">c</span>"</span></span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="bound">x</span> <span class="main"><span class="free">‚àà</span></span> upair <span class="free">c</span> <span class="free">d</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> upair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπKuratowski ordered pairs‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">kpair</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">kpair</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> upair <span class="main">(</span>upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">(</span>upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kpair_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> kpair <span class="free">c</span> <span class="free">d</span> <span class="main">‚ü∑</span> <span class="free">a</span> <span class="main">=</span> <span class="free">c</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main">=</span> <span class="free">d</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> kpair_def upair_eq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> pair_inject <span class="main">:</span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> kpair <span class="free">c</span> <span class="free">d</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="free">c</span> <span class="main">‚üπ</span> <span class="free">b</span><span class="main">=</span><span class="free">d</span> <span class="main">‚üπ</span> <span class="free">R</span><span class="main">)</span> <span class="main">‚üπ</span> <span class="free">R</span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> kpair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> pair_inject1 <span class="main">:</span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> kpair <span class="free">c</span> <span class="free">d</span> <span class="main">‚üπ</span> <span class="free">a</span><span class="main">=</span><span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> pair_inject2 <span class="main">:</span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> kpair <span class="free">c</span> <span class="free">d</span> <span class="main">‚üπ</span> <span class="free">b</span><span class="main">=</span><span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπCartesian product‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">cprod</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‚Äπ<span class="keyword1">√ó</span>‚Ä∫</span> 80<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">√ó</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> <span class="main"><span class="free">‚ãÉ</span></span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cprod_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span><span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> cprod_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> union_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> replace_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> cprod_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>  
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">z</span><span class="main">.</span> <span class="bound">z</span> <span class="main">=</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span><span class="main">)</span> <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> cprod_def
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> union_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> replace_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> cnf.iff_trans<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"bex <span class="var">?R</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main"><span class="free">‚àà</span></span> <span class="var">?R</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> replaceE2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">r</span> <span class="main"><span class="free">‚àà</span></span> <span class="var">?R</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="skolem">r</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">b</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> replaceE2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">y</span>‚Ä∫</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> 
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">‚àß</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="skolem">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> r<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span>"</span></span> 
             <span class="quoted"><span class="quoted">"Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span> <span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="skolem">a</span> <span class="bound">b</span><span class="main">)</span> <span class="free">y</span> <span class="main"><span class="free">‚àà</span></span> <span class="var">?R</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> replaceI<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"bex <span class="var">?R</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">r</span><span class="main">.</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="bound">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cprod_iff_pair <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> cprod_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> pair_inject <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> cprodI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="free">a</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI cprod_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cprodI_pair <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> kpair <span class="free">a</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI cprod_iff_pair <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cprodD1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> cprod_iff_pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cprodD2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kpair <span class="free">a</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cprod_iff_pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> cprodE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">;</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cprod_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>   

<span class="keyword1"><span class="command">lemma</span></span> cprodE_pair <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> kpair <span class="free">a</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="bound">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cprod_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>   

<span class="keyword1"><span class="command">lemma</span></span> cprod_eq <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span><span class="main">=</span><span class="free">x'</span> <span class="main">;</span> <span class="free">y</span><span class="main">=</span><span class="free">y'</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">x</span><span class="main">√ó</span><span class="free">y</span> <span class="main">=</span> <span class="free">x'</span><span class="main">√ó</span><span class="free">y'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπProjection relations‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">fst</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">œÑ</span>‚Ä∫</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">œÑ</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">‚â°</span> <span class="keyword1">Œπ'</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">b</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">snd</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">œÄ</span>‚Ä∫</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">œÄ</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">‚â°</span> <span class="keyword1">Œπ'</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">a</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> kpair_uniq1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> kpair <span class="free">a</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="main">‚àÉ!</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">b</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span> "</span></span> 
  <span class="keyword1"><span class="command">using</span></span> kpair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> kpair_uniq2 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">=</span> kpair <span class="free">a</span> <span class="free">b</span> <span class="main">‚üπ</span> <span class="main">(</span><span class="main">‚àÉ!</span><span class="bound">b</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">a</span><span class="main">.</span> <span class="free">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> kpair_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">lemma</span></span> fst_eq <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">œÑ</span> <span class="main">(</span>kpair <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> fst_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> the_def_eq'<span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> kpair_uniq1 <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> snd_eq <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">œÄ</span> <span class="main">(</span>kpair <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> snd_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> the_def_eq'<span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> kpair_uniq2 <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fst_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="keyword1">œÑ</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cprodE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> fst_eq <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> snd_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="keyword1">œÄ</span> <span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cprodE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> snd_eq <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> fst_snd_eq <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">√ó</span> <span class="free">y</span> <span class="main">‚üπ</span> kpair <span class="main">(</span><span class="keyword1">œÑ</span> <span class="free">p</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">œÄ</span> <span class="free">p</span><span class="main">)</span> <span class="main">=</span> <span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cprodE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">use</span> fst_eq snd_eq <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπBinary union and intersection‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">un</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚à™</span>‚Ä∫</span> 90<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚à™</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> <span class="main"><span class="free">‚ãÉ</span></span> upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> un_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> un_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> union_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> upair_set<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> un_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">|</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> un_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> union_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> upair_set<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> upairI1 upairI2 <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> upairE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> unI1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> unI2 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> un_subset1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subsetI<span class="main">[</span><span class="operator">OF</span> assms un_set<span class="main">]</span> unI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">lemma</span></span> un_subset2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subsetI<span class="main">[</span><span class="operator">OF</span> assms un_set<span class="main">]</span> unI2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> unE <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> unE' <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">;</span> <span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">;</span> <span class="free">a</span> <span class="main">‚àâ</span> <span class="free">x</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> unCI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">‚àâ</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">int</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚à©</span>‚Ä∫</span> 90<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚à©</span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> <span class="main">‚ãÇ</span> upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> int_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à©</span> <span class="free">y</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> int_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Int_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> upair_set<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> upairI1 upairI2 <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> upairE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> intI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à©</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> int_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> intD1 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à©</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> int_iff<span class="main">)</span>  
<span class="keyword1"><span class="command">lemma</span></span> intD2 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à©</span> <span class="free">y</span> <span class="main">‚üπ</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> int_iff<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> intE <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à©</span> <span class="free">y</span> <span class="main">;</span> <span class="main">‚ü¶</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">y</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> int_iff<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπConverting a Œª-function to a set-function‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‚ÄπPerhaps consider doing this development in a locale,
      so that we can abstract from the representation of the ordered pair.‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">converse</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">converse</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚â°</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">p</span> <span class="bound">q</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main">‚àß</span> <span class="bound">q</span> <span class="main">=</span> kpair <span class="bound">b</span> <span class="bound">a</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">domain</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">domain</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚â°</span> Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">p</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span>"</span></span>
    
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">range</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">range</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚â°</span> domain <span class="main">(</span>converse <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">field</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">field</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚â°</span> domain <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚à™</span> range <span class="free"><span class="bound"><span class="entity">r</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">relation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">relation</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">‚â°</span> ball <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">(</span><span class="main">Œª</span><span class="bound">p</span><span class="main">.</span> <span class="main">‚àÉ</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">p</span> <span class="main">=</span> kpair <span class="bound">a</span> <span class="bound">b</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">func</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span>  
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">func</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">‚â°</span> <span class="main">‚àÄ</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> kpair <span class="bound">a</span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">‚àß</span> kpair <span class="bound">a</span> <span class="bound">c</span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">‚ü∂</span> <span class="bound">b</span> <span class="main">=</span> <span class="bound">c</span>"</span></span>
  
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Lambda</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  lam_def <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Lambda</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">‚â°</span> RepFun <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> kpair <span class="bound">x</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted">"<span class="entity">apply</span>"</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">`</span>‚Ä∫</span> 90<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main"><span class="free">`</span></span><span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">‚â°</span> <span class="keyword1">Œπ'</span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span><span class="main">.</span> kpair <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="bound">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">image</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>  <span class="main">(</span><span class="quoted">‚Äπ_<span class="keyword1">[</span>_<span class="keyword1">]</span>‚Ä∫</span> 90<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">where</span></span> image_def<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main"><span class="free">[</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">]</span></span> <span class="main">‚â°</span> RepFun <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="bound">a</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>