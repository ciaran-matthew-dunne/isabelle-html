<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Model_locale</title>
</head>


<body>
<div class="head">
<h1>Theory Model_locale</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Model_locale
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Ord_locale.html">Ord_locale</a>
  <span class="keyword2"><span class="keyword">keywords</span></span> <span class="quoted">"model_interpretation"</span> <span class="quoted">"model_closed"</span> <span class="main">::</span> thy_goal 
  <span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">locale</span></span> Model <span class="main">=</span> Ord <span class="quoted"><span class="free">Mem</span></span> <span class="quoted"><span class="free">Emp</span></span> <span class="quoted"><span class="free">Set</span></span> <span class="quoted"><span class="free">Union</span></span> <span class="quoted"><span class="free">Subset</span></span> <span class="quoted"><span class="free">Pow</span></span> <span class="quoted"><span class="free">Succ</span></span> <span class="quoted"><span class="free">Inf</span></span> <span class="quoted"><span class="free">Repl</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="free">Mem</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚àà</span>‚Ä∫</span> 50<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Emp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚àÖ</span>‚Ä∫</span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚ãÉ</span>_‚Ä∫</span> <span class="main">[</span>90<span class="main">]</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Subset</span><span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚äÜ</span>‚Ä∫</span> 50<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Pow</span> <span class="main">::</span>  <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">ùí´</span>‚Ä∫</span> 90<span class="main">)</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Succ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Inf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span>  <span class="comment1">‚Äï ‚Äπwitness of Infinity‚Ä∫</span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Repl</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">[</span><span class="tfree">'d</span><span class="main">,</span><span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> bool<span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span><span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚Ñõ</span>‚Ä∫</span> 90<span class="main">)</span>  <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span>
    <span class="free">set</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">ord</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">Ops</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="free">Ignored</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="comment1">(*Consider abstracting the tag from the locale,
            because later we will want to keep the proofs,
            but not the tag*)</span>
          <span class="comment1">(*Can we make a weak set theory?*)</span>
    tags <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">set</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> <span class="free">ord</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ops_set_0 <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ops</span> <span class="free">set</span> <span class="main"><span class="free">0</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ops_set_succ <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">Œ≤</span> <span class="main">‚ü∂</span> <span class="free">Ops</span> <span class="free">set</span> <span class="main">(</span><span class="free">succ</span> <span class="bound">Œ≤</span><span class="main">)</span> <span class="main">=</span> <span class="free">Pow</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ops_set_lim <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">Œº</span><span class="main">.</span> <span class="free">Limit</span> <span class="bound">Œº</span> <span class="main">‚ü∂</span> <span class="free">Ops</span> <span class="free">set</span> <span class="bound">Œº</span> <span class="main">=</span> <span class="free">Union</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ops_0_ord <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="free">Ord</span> <span class="bound">Œ≤</span> <span class="main">‚ü∂</span> <span class="free">Ops</span> <span class="free">ord</span> <span class="bound">Œ≤</span> <span class="free">x</span> <span class="main">=</span> sng <span class="bound">Œ≤</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    ops_setseq_ax <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">Œ≤</span> <span class="bound">x</span><span class="main">.</span> setseq <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">Œ±</span> <span class="bound">Œ≤</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ig_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span><span class="free">Ignored</span><span class="main">)</span>"</span></span>
  
<span class="keyword1"><span class="command">context</span></span> Model <span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπTagging operations - currently implemented with Kuratowski pairs‚Ä∫</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Tag</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">‚Äπ<span class="keyword1">‚ñπ</span>‚Ä∫</span> 70<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main"><span class="free">‚ñπ</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> kpair <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">TagOf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">TagOf</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="keyword1">œÑ</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">ObjOf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ObjOf</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="keyword1">œÄ</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπTag all members of a set‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">TagSetMems</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">TagSetMems</span> <span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> RepFun <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span> <span class="main">‚ñπ</span> <span class="bound">a</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tmap_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>TagSetMems <span class="free">Œ≤</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> TagSetMems_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> repfun_set<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tmap_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="free">Œ≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> TagSetMems_def  
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> repfun_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span>
      <span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tmapI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="free">Œ≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> setI tmap_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 

<span class="keyword1"><span class="command">lemma</span></span> tmapD <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">‚üπ</span> bex <span class="free">x</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> TagSetMems_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> repfunE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tmapE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" <span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">;</span> 
    <span class="main">‚ãÄ</span><span class="bound">b'</span><span class="main">.</span><span class="main">‚ü¶</span> <span class="bound">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> "</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> TagSetMems_def  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> repfunE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπDisjoint Union of a sequence of sets‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">disj</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span><span class="main">]</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">‚®Ñ</span>‚Ä∫</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚®Ñ</span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">‚â°</span> <span class="main"><span class="free">‚ãÉ</span></span> RepFun <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span><span class="main">.</span> TagSetMems <span class="bound">b</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">predSet</span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span>"</span></span> 

<span class="keyword1"><span class="command">lemma</span></span> disj_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span><span class="main">‚®Ñ</span> <span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> disj_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> union_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> repfun_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> predset_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> œâ_ord<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> disj_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"setseq <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚®Ñ</span> <span class="free">X</span> <span class="main">‚ü∑</span> <span class="main">(</span>rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="bound">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> bex <span class="main">(</span><span class="free">X</span> <span class="bound">Œ≤</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> disj_def 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> repfun_union<span class="main"><span class="main">[</span></span><span class="operator">OF</span> predset_set<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> œâ_ord<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"bex <span class="main">(</span><span class="free">predSet</span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="bound">Œ≤</span> <span class="main">(</span><span class="free">X</span> <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Œ≤</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="skolem">Œ≤</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">Œ≤</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> predset_iff<span class="main">[</span><span class="operator">OF</span> œâ_ord<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="bound">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> bex <span class="main">(</span><span class="free">X</span> <span class="bound">Œ≤</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> rex_def
    <span class="keyword1"><span class="command">using</span></span> assms <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> tmapE<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="bound">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> bex <span class="main">(</span><span class="free">X</span> <span class="bound">Œ≤</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Œ≤</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">b'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">Œ≤</span> <span class="main">‚ñπ</span> <span class="skolem">b'</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="skolem">Œ≤</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Œ≤</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">predSet</span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="skolem">Œ≤</span> <span class="main">(</span><span class="free">X</span> <span class="skolem">Œ≤</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> predset_iff<span class="main">[</span><span class="operator">OF</span> œâ_ord<span class="main">]</span> tmap_iff assms <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"bex <span class="main">(</span><span class="free">predSet</span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> TagSetMems <span class="bound">Œ≤</span> <span class="main">(</span><span class="free">X</span> <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*Weaker version*)</span>
<span class="keyword1"><span class="command">lemma</span></span> disj_iff' <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"setseq <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚®Ñ</span> <span class="free">X</span> <span class="main">‚ü∑</span> <span class="free">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> <span class="free">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="free">Œ≤</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> disj_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> disjI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="free">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="free">Œ≤</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚®Ñ</span> <span class="free">X</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> disj_def <span class="keyword1"><span class="command">using</span></span> 
    repfun_union<span class="main">[</span><span class="operator">OF</span> predset_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> œâ_ord<span class="main"><span class="main">]</span></span><span class="main">]</span> 
    predset_iff<span class="main">[</span><span class="operator">OF</span> œâ_ord<span class="main">]</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> tmapI<span class="main">)</span>
  
<span class="keyword1"><span class="command">lemma</span></span> disjE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"setseq <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="main">‚®Ñ</span> <span class="free">X</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">Œ≤</span> <span class="bound">b'</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span> <span class="main">;</span> <span class="bound">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="bound">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="bound">Œ≤</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> disj_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπSubset of a tagged set with tag Œ≤‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Part</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">Part</span> <span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> Collect <span class="main">(</span><span class="main">Œª</span><span class="bound">b</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">b'</span><span class="main">.</span> <span class="bound">b</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> part_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>Part <span class="free">Œ≤</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Part_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> collect_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">‚ü∑</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÉ</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Part_def <span class="keyword1"><span class="command">using</span></span> collect_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> partI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b'</span><span class="main">)</span><span class="main">;</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_iff setI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> partD1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="keyword1">œÑ</span> <span class="free">b</span> <span class="main">=</span> <span class="free">Œ≤</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main">]</span> fst_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> partD2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> part_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> partE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">b'</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">;</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> partD_pair <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="free">x</span> <span class="main">‚üπ</span> <span class="free">Œ±</span> <span class="main">=</span> <span class="free">Œ≤</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> pair_inject <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> part_subset <span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span> <span class="main">‚üπ</span> Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> subset_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>Part <span class="free">Œ±</span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>Part <span class="free">Œ±</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> part_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">x</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> <span class="free">y</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> partI <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> partE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> part_union <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Part <span class="free">Œ±</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main">‚à™</span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> equality_iffI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> part_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> un_set<span class="main"><span class="main">]</span></span> un_set<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> un_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span>"</span></span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main">‚à®</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> partE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> un_set<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a'</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="skolem">a'</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span>‚Ä∫</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main">‚à®</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> unE <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> partI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">a</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="skolem">a'</span><span class="main">)</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">x</span> <span class="main">‚à®</span> <span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">x</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> part_subset<span class="main">[</span><span class="operator">OF</span> un_subset1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">x</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="free">y</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span><span class="free">x</span> <span class="main">‚à™</span> <span class="free">y</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> part_subset<span class="main">[</span><span class="operator">OF</span> un_subset2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Set</span> <span class="free">y</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> part_disj_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"setseq <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="main">(</span><span class="main">‚®Ñ</span> <span class="free">X</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> bex <span class="main">(</span><span class="free">X</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">b'</span><span class="main">.</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>  
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> part_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> disj_set<span class="main"><span class="main">]</span></span> disj_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπsetseq <span class="free">X</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> 
      <span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_disjI <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="free">b'</span><span class="main">)</span> <span class="main">;</span> <span class="free">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="free">Œ≤</span> <span class="main">;</span> <span class="free">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="main">(</span><span class="main">‚®Ñ</span> <span class="free">X</span><span class="main">)</span>"</span></span>  
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> partI disjI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_disjE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"setseq <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">b</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ≤</span> <span class="main">(</span><span class="main">‚®Ñ</span> <span class="free">X</span><span class="main">)</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">b'</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="free">b</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ≤</span> <span class="main">‚ñπ</span> <span class="bound">b'</span><span class="main">)</span> <span class="main">;</span> <span class="free">Œ≤</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="bound">b'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">X</span> <span class="free">Œ≤</span>  <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_disj_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword1"><span class="command">lemma</span></span> set_tag <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">set</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tags<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> ord_tag <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ord</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tags<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπTier -- model building operator‚Ä∫</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Tier</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> <span class="tfree">'d</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
 <span class="quoted"><span class="quoted">"<span class="free">Tier</span> <span class="main">‚â°</span> <span class="free">OrdRec</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œº</span> <span class="bound">x</span><span class="main">.</span> <span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">Œ±</span> <span class="bound">Œº</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> 
                <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚à™</span> <span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">Œ±</span> <span class="bound">Œ≤</span> <span class="main">(</span><span class="bound">x</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
                <span class="main">(</span><span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ops_setseq <span class="main">:</span> <span class="quoted"><span class="quoted">"setseq <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">Œ±</span> <span class="free">Œ≤</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ops_setseq_ax<span class="main">)</span>

<span class="keyword1"><span class="command">thm</span></span> disj_iff'<span class="main">[</span><span class="operator">OF</span> ops_setseq<span class="main">]</span>  

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπGeneral lemmas about the structure of Tier‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tier_0 <span class="main">:</span> <span class="quoted"><span class="quoted">"Tier <span class="main"><span class="free">0</span></span> <span class="main">=</span> <span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">a</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> Tier_def <span class="keyword1"><span class="command">using</span></span> ordrec_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> tier0_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="main"><span class="free">0</span></span> <span class="main">‚ü∑</span> rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="bound">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="bound">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> tier_0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> disj_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> ops_setseq<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tier0_iff' <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="main"><span class="free">0</span></span> <span class="main">‚ü∑</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span> "</span></span>
  <span class="keyword1"><span class="command">using</span></span> tier0_iff <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_succ <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">=</span> Tier <span class="free">Œ≤</span> <span class="main">‚à™</span> <span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">a</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Tier_def <span class="keyword1"><span class="command">using</span></span> ordrec_succ assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_succ_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="free">Œ≤</span> <span class="main">‚à®</span> <span class="main">(</span>rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="bound">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="bound">Œ±</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> tier_succ<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> un_iff disj_iff<span class="main">[</span><span class="operator">OF</span> ops_setseq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_succ_iff' <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span><span class="main">)</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="free">Œ≤</span> <span class="main">‚à®</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tier_succ_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_limit <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Tier <span class="free">Œº</span> <span class="main">=</span> <span class="main">‚®Ñ</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span><span class="main">.</span> <span class="free">Ops</span> <span class="bound">a</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Tier_def <span class="keyword1"><span class="command">using</span></span> ordrec_lim assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_limit_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="free">Œº</span> <span class="main">‚ü∑</span> rex <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="bound">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="bound">Œ±</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="bound">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> tier_limit<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> disj_iff<span class="main">[</span><span class="operator">OF</span> ops_setseq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_limit_iff' <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="free">Œº</span> <span class="main">‚ü∑</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tier_limit_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> tier_set <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>Tier <span class="free">Œ≤</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ord_cases<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> disj_set un_set tier_0 tier_succ tier_limit<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> tier0_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Set</span> <span class="main">(</span>Tier <span class="main"><span class="free">0</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tier_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> zero_ord<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">corollary</span></span> tiersucc_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tier_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> succ_ord<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">corollary</span></span> tierlimit_set <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span> <span class="main">‚üπ</span> <span class="free">Set</span> <span class="main">(</span>Tier <span class="free">Œº</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> tier_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> limit_ord<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπParts of Tier‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> part_tier0_iff <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main"><span class="free">0</span></span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="free">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> part_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> tier0_set<span class="main"><span class="main">]</span></span> tier0_iff<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tier0I <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main"><span class="free">0</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tier0_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tier0E <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main"><span class="free">0</span></span><span class="main">)</span> <span class="main">;</span> <span class="main">‚ãÄ</span><span class="bound">x'</span><span class="main">.</span> <span class="main">‚ü¶</span> <span class="bound">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main"><span class="free">0</span></span> <span class="main"><span class="free">‚àÖ</span></span> <span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tier0_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">(* A strong but ugly lemma for the successor case *)</span>
<span class="keyword1"><span class="command">lemma</span></span> part_tiersucc_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∑</span>
  <span class="main">(</span><span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œ≤</span><span class="main">)</span> <span class="main">‚à®</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="free">Œ±</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tier_succ<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">]</span></span> 
                part_union<span class="main"><span class="main">[</span></span><span class="operator">OF</span> tier_set<span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">]</span></span></span> disj_set<span class="main"><span class="main">]</span></span> 
                un_iff part_disj_iff<span class="main"><span class="main">[</span></span><span class="operator">OF</span> ops_setseq<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tiersuccI1 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span><span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span><span class="main">‚üß</span> 
        <span class="main">‚üπ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tiersucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tiersuccI2 <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œ≤</span><span class="main">)</span> <span class="main">‚üπ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tiersucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tiersuccE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span> <span class="main">;</span>
        <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œ≤</span><span class="main">)</span>  <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">;</span> 
  <span class="main">‚ãÄ</span><span class="bound">x'</span><span class="main">.</span><span class="main">‚ü¶</span> <span class="bound">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span> <span class="main">(</span>Tier <span class="free">Œ≤</span> <span class="main">-</span> <span class="free">Ignored</span><span class="main">)</span> <span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tiersucc_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> part_tierlim_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œº</span><span class="main">)</span> <span class="main">‚ü∑</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">‚àß</span> bex <span class="main">(</span><span class="free">Ops</span> <span class="free">Œ±</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">x'</span><span class="main">.</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> part_iff<span class="main">[</span><span class="operator">OF</span> tierlimit_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Limit</span> <span class="free">Œº</span>‚Ä∫</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> tier_limit_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">Limit</span> <span class="free">Œº</span>‚Ä∫</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> pair_inject<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tierlimI <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">Œ±</span> <span class="main"><span class="free">&lt;</span></span> <span class="keyword1"><span class="free">œâ</span></span> <span class="main">;</span> <span class="free">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="free">x'</span><span class="main">‚üß</span> 
        <span class="main">‚üπ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œº</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tierlim_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> part_tierlimitE <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Limit</span> <span class="free">Œº</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Part <span class="free">Œ±</span> <span class="main">(</span>Tier <span class="free">Œº</span><span class="main">)</span> <span class="main">;</span>
  <span class="main">‚ãÄ</span><span class="bound">x'</span><span class="main">.</span><span class="main">‚ü¶</span> <span class="bound">x'</span> <span class="main"><span class="free">‚àà</span></span> <span class="free">Ops</span> <span class="free">Œ±</span> <span class="free">Œº</span> <span class="main">(</span>Lambda <span class="main">(</span><span class="free">predSet</span> <span class="free">Œº</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ≤</span><span class="main">.</span> Tier <span class="bound">Œ≤</span><span class="main">)</span><span class="main">)</span> <span class="main">;</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Œ±</span> <span class="main">‚ñπ</span> <span class="bound">x'</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span> <span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> part_tierlim_iff<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‚ÄπStructure of the 'set' part of Tier‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> tier_set_0 <span class="main">:</span> <span class="quoted"><span class="quoted">"Part <span class="free">set</span> <span class="main">(</span>Tier <span class="main"><span class="free">0</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equals0I<span class="main"><span class="main">[</span></span><span class="operator">OF</span> part_set<span class="main"><span class="main">[</span></span><span class="operator">OF</span> tier0_set<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> part_tier0_iff ops_set_0<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">thm</span></span> part_tiersucc_iff
<span class="keyword1"><span class="command">thm</span></span> powI
<span class="keyword1"><span class="command">lemma</span></span> tier_set_succ <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Part <span class="free">set</span> <span class="main">(</span>Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Pow</span> <span class="main">(</span>Tier <span class="free">Œ≤</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">sorry</span></span>

<span class="keyword1"><span class="command">lemma</span></span> subset_succ_iff <span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Ord</span> <span class="free">Œ≤</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main"><span class="free">‚äÜ</span></span> Tier <span class="free">Œ≤</span> <span class="main">‚ü∑</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="main">(</span><span class="free">succ</span> <span class="free">Œ≤</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">sorry</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">inModel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> <span class="main">‚áí</span> bool"</span></span> <span class="main">(</span><span class="quoted">‚Äπ<span class="keyword1">M</span>‚Ä∫</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">inModel</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> rex <span class="free">Ord</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">Œ±</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="bound">Œ±</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> modelI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚ü¶</span><span class="free">Ord</span> <span class="free">i</span> <span class="main">;</span> <span class="free">x</span> <span class="main"><span class="free">‚àà</span></span> Tier <span class="free">i</span><span class="main">‚üß</span> <span class="main">‚üπ</span> <span class="keyword1">M</span> <span class="free">x</span>"</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> inModel_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> rexI<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">mall</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'d</span> <span class="main">‚áí</span> bool<span class="main">)</span> <span class="main">‚áí</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">mall</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> rall inModel <span class="free"><span class="bound"><span class="entity">P</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mex</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> rex inModel <span class="free"><span class="bound"><span class="entity">P</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">muniq</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> mall <span class="main">(</span><span class="main">Œª</span><span class="bound">y</span><span class="main">.</span> mall <span class="main">(</span><span class="main">Œª</span><span class="bound">z</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">y</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">z</span> <span class="main">‚ü∂</span> <span class="bound">y</span> <span class="main">=</span> <span class="bound">z</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mrall</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">‚â°</span> mall <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mrex</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">‚â°</span> mex <span class="main">(</span><span class="main">Œª</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">fun_mall</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">F</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">‚ü∂</span> <span class="keyword1">M</span> <span class="main">(</span><span class="bound">F</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∂</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">binfun_mall</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">‚â°</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">F</span><span class="main">.</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="keyword1">M</span> <span class="bound">x</span> <span class="main">‚àß</span> <span class="keyword1">M</span> <span class="bound">y</span> <span class="main">‚ü∂</span> <span class="keyword1">M</span> <span class="main">(</span><span class="bound">F</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="main">‚ü∂</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="bound">F</span><span class="main">)</span>"</span></span>

<span class="comment1">(*Model versions of GZF constants
  Higher-order parameters of model operators MUST be restricted to the model,
  otherwise it is painful to prove transfer rules.*)</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">forceM</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">forceM</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="keyword1">if</span> <span class="keyword1">M</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">else</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mEmp</span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main"><span class="free">‚àÖ</span></span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mSet</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> TagOf <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free">set</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mMem</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> mSet <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚àß</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main"><span class="free">‚àà</span></span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mSubset</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚â°</span> mSet <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚àß</span> mSet <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">.</span> mMem <span class="bound">a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚ü∂</span> mMem <span class="bound">a</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mPow</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>TagSetMems <span class="free">set</span>  <span class="main">(</span><span class="free">Pow</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mUnion</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span><span class="main"><span class="free">‚ãÉ</span></span> <span class="main">(</span>RepFun ObjOf <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mSucc</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> mUnion <span class="main">(</span><span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>upair <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span><span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>sng <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œò</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">‚â°</span> <span class="free">OrdRec</span> <span class="main">(</span><span class="main">Œª</span><span class="main"><span class="bound">_</span></span> <span class="bound">x</span><span class="main">.</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="main"><span class="bound">_</span></span> <span class="bound">x</span><span class="main">.</span> mSucc <span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="free">set</span> <span class="main">‚ñπ</span> <span class="main"><span class="free">‚àÖ</span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mInf</span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>Œò <span class="keyword1"><span class="free">œâ</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mRepl</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>Replace <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">(</span>forceM <span class="bound">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">(*Model versions of Ord constants*)</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mOrd_conv</span> <span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span> <span class="main">‚â°</span> <span class="free">ord</span> <span class="main">‚ñπ</span> <span class="free"><span class="bound"><span class="entity">Œ≤</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mOrd</span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> TagOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">=</span> <span class="free">ord</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mpredSet</span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> <span class="free">set</span> <span class="main">‚ñπ</span> <span class="main">(</span>TagSetMems <span class="free">ord</span> <span class="main">(</span><span class="free">predSet</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mOrdRec</span> <span class="free"><span class="bound"><span class="entity">L</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> <span class="free">OrdRec</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">L</span></span></span> <span class="main">(</span>forceM <span class="bound">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">Œª</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">(</span>forceM <span class="bound">a</span><span class="main">)</span> <span class="main">(</span>forceM <span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mlt</span> <span class="free"><span class="bound"><span class="entity">ùíú</span></span></span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">ùíú</span></span></span><span class="main">)</span> <span class="main"><span class="free">&lt;</span></span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mzero</span> <span class="main">‚â°</span> <span class="free">ord</span> <span class="main">‚ñπ</span> <span class="main"><span class="free">0</span></span>"</span></span> 
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mone</span> <span class="main">‚â°</span> <span class="free">ord</span> <span class="main">‚ñπ</span> <span class="free">set</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">msucc</span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> <span class="free">ord</span> <span class="main">‚ñπ</span> <span class="main">(</span><span class="free">succ</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">mLimit</span> <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span> <span class="main">‚â°</span> <span class="free">Limit</span> <span class="main">(</span>ObjOf <span class="free"><span class="bound"><span class="entity">‚Ñ¨</span></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">momega</span> <span class="main">‚â°</span> <span class="free">ord</span> <span class="main">‚ñπ</span> <span class="keyword1"><span class="free">œâ</span></span>"</span></span>

<span class="keyword1"><span class="command">ML_file</span></span> <span class="quoted">‚Äπtranslate_locale.ML‚Ä∫</span>

<span class="keyword1"><span class="command">model_interpretation</span></span> trans_gzf <span class="main">:</span> mGZF
  <span class="keyword1"><span class="command">sorry</span></span>

<span class="keyword1"><span class="command">model_interpretation</span></span> trans_ord <span class="main">:</span> mOrd 
  <span class="keyword1"><span class="command">sorry</span></span>


<span class="keyword1"><span class="command">ML</span></span> <span class="quoted">‚ÄπGoal.prove‚Ä∫</span>

<span class="keyword1"><span class="command">ML_file</span></span> <span class="quoted">‚Äπmodel_closed.ML‚Ä∫</span>

<span class="keyword1"><span class="command">model_closed</span></span> closed_gzf <span class="main">:</span> mGZF
  <span class="keyword1"><span class="command">sorry</span></span>

<span class="keyword1"><span class="command">model_closed</span></span> closed_ord <span class="main">:</span> mOrd
  <span class="keyword1"><span class="command">sorry</span></span>

<span class="keyword1"><span class="command">lemma</span></span> forceM_elim <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="main">(</span>forceM <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> forceM_def closed_gzf<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> mEmp_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> forceM_eq <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">M</span> <span class="free">x</span> <span class="main">‚üπ</span> forceM <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> forceM_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">end</span></span>






    </pre>
</body>

</html>